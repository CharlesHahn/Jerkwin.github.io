---
 layout: post
 title: GMXTOP：OPLSAA力场的GROMACS拓扑文件生成器
 categories:
 - 科
 tags:
 - gmx
---

- 2017-06-29 21:46:49

使用GROMACS进行分子动力学模拟时, 获得体系的拓扑文件是关键, 也是难点. 虽然有些辅助工具可以直接获得一些分子的拓扑文件, 但你仍然需要对得到的拓扑文件进行仔细检查, 否则的话, MD过程中出现问题很难排查.

[tppmktop](https://jerkwin.github.io/2015/12/13/TPPMKTOP-OPLS-AA%E5%85%A8%E5%8E%9F%E5%AD%90%E5%8A%9B%E5%9C%BA%E7%9A%84GROMACS%E6%8B%93%E6%89%91%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E5%99%A8/)是获得有机分子OPLSAA力场拓扑文件的好工具, 但也存在一定的不足. 一是不支持周期性分子, 二是提供的网络服务同时只能运行一个任务. 为此, 我觉得还是有必要自己做一个简单OPLSAA力场拓扑生成器GMXTOP, 一则可用于理解力场拓扑的生成方法, 二则可用于检查其他方法得到的拓扑是否合适.

GMXTOP是个在线工具, 运行在浏览器中, 不依赖于任何其他环境. 它并不支持自动生成拓扑文件, 而是需要你先指定每个原子的原子类型, 然后它会根据原子类型和力场文件中的参数信息生成GROMACS的拓扑文件. 虽然GMXTOP不是完全自动的, 使用起来有点不方便, 但使用它你可以明确地控制如何指定原子类型, 遇到其他工具无法自动匹配的原子时, 你就可以根据情况选用相近的原子类型, 保证最终能得到合适的拓扑文件.

## 使用说明

打开GMXTOP网页 <https://Jerkwin.github.io/Prog/gmxtop.html>. 建议使用Chrome, 因为我没有测试其他浏览器. 界面尚未美化, 看起来有点简陋.

### 分子构型格式

暂时支持读入`.pdb`和`.mol`格式的分子构型文件, 而且文件中必须包含原子间的连接信息, 因为程序要使用这些连接信息来确定原子间的成键信息.

这两种格式的分子构型文件可以使用GaussView获得, 程序只测试过GaussView的输出格式, 尚未测试其他分子编辑软件. 鉴于各种软件给出的`.pdb`格式不尽相同, 建议优先使用`.mol`格式.

### 指定原子类型

有两种方式指定原子类型:

1. 右上方分子结构窗口中点击原子后, 原子会高亮, 同时弹出所有可能匹配的原子类型及其相应的示意图. 图片中对应的原子类型以红色表示. 双击图片即可完成指定. 也可选点击图片前面的按钮, `OK`确认后完成指定.
2. 如果需要同时指定多个原子的原子类型, 可在左上方文本框内选中多个原子, 然后点击`Assign Atom Type`, 然后指定. 当然, 这种方法也可以用于单个原子.

如果判断原子类型存在困难, 你可以试着先用tppmktop来处理一下, 参考它给出的原子类型. 在大多数情况下, tmmktop给出的原子类型都是正确的.

### 生成拓扑文件

指定好每个原子的原子类型后, `OPLSAA Atom Types`文本框内会列出每个原子的原子类型, 这些原子类型也可以直接进行修改. 确认正确后, 点击`Create Topology File`即可生成GROMACS拓扑文件. 点击`Save Topology File`即可下载生成的拓扑文件.

如果你要使用拓扑文件中的电荷, 一个判断拓扑文件好坏的简单标准就是看整个分子的净电荷`qtot`与实际是否相符. 如果基本相符, 那说明原子类型的指认还是比较正确的. 否则的话, 那就需要你仔细检查每个原子的原子类型了.

对一些特殊的原子类型, 它们之间的成键相互作用项可能缺失, 得到的拓扑文中会标识`!!! NOT DEFINED !!!`. 在使用拓扑文件前, 你需要将这些缺失项补充完整. 补充的方法一个是拟合, 一个是采用相近原子类型的成键参数.

### 其他辅助功能

- 鼠标滚轮: 缩放
- `Ctrl`+鼠标左键: 平移
- `Labels`: 可显示每个原子的编号, 用于区分
- `Hide H`: 隐藏氢原子
- `Reset View`: 重新将分子居中显示
- `Rot X/Y/Z`: 自动旋转开关

## 简单示例(略)

### MeNO2

### PhCNHNH2

### 石墨烯

## 待完成

1. 反常二面角原子顺序可能与其他程序所给的不一致, 待考.
1. OPLS原子类型示例图已完成, 但可能存在错误之处, 待查.
2. 扩展到支持其他力场的原子类型, 如amber, charmm等.
5. 对分子结构进行分析, 显示原子类型时按匹配度高低排序, 尽可能自动化, 减少选择时的纠结.
3. 美化界面
4. 分子结构显示可换用Three.js, CH5M3D效果和效率不佳.

## 致谢

没有下面这些人的热心付出, GMXTOP工具是很难完成的. 如果你使用这个工具, 请感谢他们的努力与付出.

- 张楠@北京   :  58-96
- 蒲中机@大连 : 101-130
- 黄建湘@杭州 : 141-173
- 叶盛@合肥   : 178-192, 197-212
- 梅龙灿@武汉 : 217, 222-241
- 刘恒江@上海 : 247-282
- 郝阳@上海   : 285-318
- 马郑@天津   : 320-348
- 康文渊@成都 : 349-380
- 刘清南@西安 : 398-424
- 杜春保@西安 : 425-459
- 李正@西安   : 460-473, 490-496
- 吴思晋@大连 : 497-537
- 刘凤海@成都 : 569-598
- 刘胜堂@苏州 : 603-645
- 张国成@成都 : 645-681
- 席昆@武汉   : 542-565, 677-713, 913-940
- 吴念@武汉   : 714-748
- 李乐乐@成都 : 749-758, 771-779, 785
- 王新宇@天津 : 941-MW
