---
 layout: post
 title: GROMACS中文手册第7章：运行参数和程序 7.3.16-7.3.22
 categories:
 - 科
 tags:
 - GMX
---

# 第七章　运行参数和程序

## 7.3 运行参数

### 7.3.16 模拟退火

在GROMACS中, 对每个温度组的模拟退火是分开控制的. 参考温度是一个分段线性函数, 对每个组可以使用任意数目的点, 并选择单一序列或周期性退火类型. 实际退火是通过动态地改变参考温度进行的, 由于选择的温控算法也使用该温度, 所以要记住, 体系通常不会瞬间达到参考温度!

`annealing`:  
每个温度组的退火类型

- `no`  
不进行模拟退火, 只耦合到参考温度.

- `single`  
退火点的单一序列. 如果模拟时间比最后一点的时间还长, 当退火序列达到最后的时间点后, 温度将耦合到最后一点的值并保持不变.

- `periodic`  
一旦到达最后的参考时间, 退火将从第一个参考点重新开始. 此过程不断重复, 直到模拟结束.

`annealing-npoints`:  
退火参考/控制点数目的列表, 用于每个温度组. 对不退火的组使用0. 此项的数目应等于温度组的数目.

`annealing-time`:  
退火参考/控制点的时间列表, 用于每个温度组.如果你正使用周期性退火类型, 时间将与最终值取模, 即, 如果时间为0, 5, 10和15, 耦合将会在15 ps, 30 ps, 45 ps等时间点后以0 ps时值重新启动. 此项的数目应该等于`annealing-npoints`给出的数字的总和.

`annealing-temp`:  
退火参考/控制点的温度列表, 用于每个温度组. 此项的数目应该等于`annealing-npoints`给出的数字的总和.

很迷惑? 好吧, 让我们举个例子. 假设你有两个温度组, 组的选择设置为`annealing = single periodic`, 组的点数设置为`annealing-npoints = 3 4`, 退火时间设置为`annealing-time = 0 3 6 0 2 4 6`, 温度设置为`annealing-temp = 298 280 270 298 320 320 298`. 在0 ps第一组将被耦合到298 K, 但参考温度在3 ps内将线性下降到280 K, 然后在3 ps到6 ps这段时间内, 温度将从280 K线性变化到270 K. 在这之后温度保持270 K不变. 0 ps时第二组被耦合到298 K, 在2 ps内温度线性增加到320 K, 并保持不变直到4 ps. 在4 ps和6 ps之间温度降低到298 K, 然后将以同样的方式重新开始, 即在6 ps和8 ps之间从298 K线性上升到320 K. 如果你不确定, 请检查`grompp`给出的汇总信息!

### 7.3.17 速度产生

`gen-vel`:

- `no`  
不产生速度. 当输入结构文件中不存在速度时, 速度被设置为零.

- `yes`  
`grompp`根据温度为`gen-temp` [K]的麦克斯韦分布产生速度, 随机数种子为`gen-seed`. 此选项只对`md`积分器有意义.

`gen-temp`: (300) [K]  
麦克斯韦分布的温度

`gen-seed`: (-1) [整数]  
用于初始化产生随机速度的随机数发生器, 当`gen-seed`设置为-1时, 将使用伪随机种子.

### 7.3.18 键约束

`constraints`:

- `none`  
除在拓扑中明确定义的键外, 不使用任何约束, 即, 利用简谐(或其他)势或Morse势(取决于`morse`的设置)描述键, 利用简谐(或其他)势描述键角.

- `h-bonds`  
将含有氢原子的键转换为约束.

- `all-bonds`  
将所有的键都转换为约束.

- `h-angles`  
将所有涉及氢原子的键和键角都转换为键约束.

- `all-angles`  
将所有的键和键角都转换为键约束.

`constraint-algorithm`:

- `LINCS`  
线性约束求解器(LINear Constraint Solver). 区域分解会与并行版本的P-LINCS一起使用. 使用`lincs-order`设置精度, 同时也设置矩阵求逆展开中矩阵的数目. 经过矩阵求逆校正后, 算法会执行一次迭代校正以补偿因旋转导致的增长. 这种迭代的次数可以通过`lincs-iter`控制. 每`nstlog`步, 相对约束的根均方偏差会打印到日志文件. 如果某根键在一步中的旋转超过了`lincs-warnangle`(度), 将打印警告到日志文件和`stderr`. LINCS不能用于耦合键角约束.

- `SHAKE`  
与LINCS相比, SHAKE方法稍慢, 且不太稳定, 但能用于键角约束. 相对容差由`shake-tol`设置, 对"正常"的MD, 0.0001是合适的值. SHAKE不支持处于不同节点上的原子之间的约束, 因此当存在电荷组之间的约束时, 它不能与区域分解一起使用. SHAKE不能用于能量最小化.

`continuation`:  
此选项以前的名字为`unconstrained-start`.

- `no`  
对初始构型施加约束并复位壳层

- `yes`  
不对初始构型施加约束, 不复位壳层, 对准确的延续和重新运行很有用.

`shake-tol`: (0.0001)  
SHAKE相对容差

`lincs-order`: (4)  
约束耦合矩阵展开的最高阶数. 当约束形成三角形时, 在这些三角形约束的正常展开之上会施加一个相同阶的展开. 对"正常"的MD模拟通常4阶就足够了; 对含有虚拟位点或BD并使用大时间步长的模拟, 需要使用6阶; 对精确的能量最小化, 可能需要使用8或更高的阶数. 与区域分解联用时, 原胞的大小由`lincs-order`+1个约束张成的距离决定. 如果想进行超过此限制的缩放, 可以降低`lincs-order`, 增加`lincs-iter`, 因为当(1+`lincs-iter`)*`lincs-order`保持不变时, 精度不会变差.

`lincs-iter`: (1)  
LINCS中用于校正旋转增长的迭代次数. 对于正常的运行一步就足够了. 但对于NVE模拟, 如果需要精确的能量守恒或精确的能量最小化, 你可能需要将其增加到2.

`lincs-warnangle`: (30) [度]  
LINCS失效前键能够旋转的最大角度.

`morse`:

- `no`  
使用简谐势描述键

- `yes`  
使用Morse势描述键

### 7.3.19 能量组排除

`energygrp-excl`:  
所有非键相互作用被排除在外的能量组对. 例如: 如果你有两个能量组`Protein`和`SOL`, 指定  
`energygrp-excl = Protein Protein SOL SOL`  
只会给出蛋白质和溶剂之间的非键相互作用. 对于加快`mdrun -rerun`的能量计算, 排除冻结组之间的相互作用, 此选项特别有用.

### 7.3.20 墙

`nwall`: 0  
当设置为`1`时, 在`z=0`处存在一面墙; 当设置为`2`时, 还存在一面位于`z=z-box`处的墙. 墙只能用于`pbc=xy`. 当设置为`2`时, 可以使用压力耦合与Ewald加和(通常最好是使用半各向同性的压力耦合, 并将`x/y`的压缩率设置为0, 否则表面积会发生变化). 墙会与体系的其余部分进行相互作用, 其`atomtype`是可选的. 会自动增加能量组`wall0`和`wall1`(`nwall=2`时)以监测能量组与每面墙之间的相互作用. Z方向的质心运动移除将被关闭.

`wall-atomtype`:  
每面墙在力场中的原子类型名称. 通过(例如)在拓扑文件中定义一个特殊的墙原子类型及其组合规则, 可以独立地调整每个原子类型和墙的相互作用.

`wall-type`:

- `9-3`  
对墙后体积进行积分的LJ势: 9-3势

- `10-4`  
对墙面进行积分的LJ势: 10-4势

- `12-6`  
直接的LJ势, 由与墙的Z距离决定

- `table`  
用户定义的势, 根据与墙的Z距离进行索引, 以类似于`energygrp-table`的选项读入, 其中的第一个名称为"正常"能量组, 第二名称为`wall0`或`wall1`, 只使用表中的色散和排斥列.

`wall-r-linpot`: -1 [nm]  
与墙的距离在此值以下时, 势能线性连续, 因此力为常数. 当一些原子超过墙时, 将此选项设置为正值对平衡尤其有用. 当此值 $\le 0$ (对`wall-type=table`则是<0)时, 原子超过墙后会产生致命错误.

`wall-density`:  [nm^-3^/nm^-2^]  
每面墙的原子数密度, 适用于类型为9-3和10-4的墙

`wall-ewald-zfac`: 3  
第三个盒矢量的缩放因子, 仅用于Ewald加和, 最小值为2. Ewald加和只能与`nwall=2`联用, 并需要使用`ewald-geometry=3dc`. 盒子中真空层的作用是降低周期性映象之间不合实际的库仑相互作用.

### 7.3.21 质心牵引

`pull`:

- `no`  
不使用质心牵引. 以下所有的牵引选项都将被忽略(选项如果存在于`.mdp`文件中会导致警告)

- `umbrella`  
使用参考组与一个或多个组之间的伞势牵引质心

- `constraint`  
使用参考组与一个或多个组之间的约束牵引质心. 设置与`umbrella`完全相同, 除了使用的是刚性约束而不是简谐势.

- `constant-force`  
使用线性势牵引质心, 拉力恒定. 此选项没有参考位置, 因此不会使用参数`pull-init`和`pull-rate`.

`pull-geometry`:

- `distance`  
沿着连接两组的矢量进行牵引. 可以使用`pull-dim`选择分量.

- `direction`  
在`pull-vec`方向进行牵引.

- `direction-periodic`  
与`direction`相同, 但允许距离超过盒长的一半. 使用这种几何设置, 盒子在牵引维度不应该发生变化(例如, 无压力缩放), 不会将拉力添加到维里.

- `cylinder`  
用于相对于层的牵引, 参考质心由参考组的一个局部圆柱部分给出. 牵引方向为 `pull-vec`. 使用两个半径从参考组中选择一个圆柱, 圆柱围绕的轴以`pull-vec`方向通过牵引组. 半径`pull-r1`之内的所有相对权重为1, `pull-r1`和`pull-r0`之间的权重被切换到零. 也会使用质量权重. 注意, 半径应小于盒子长度的一半. 对于倾斜圆柱, 半径应该比盒长一半更小, 因为参考组中的原子与牵引组质心同时具有径向和轴向分量.

`pull-dim`: (Y Y Y)  
与牵引几何设置`distance`联用的距离分量, 也会设置打印到输出文件的分量.

`pull-r1`: (1) [nm]  
牵引几何`cylinder`的圆柱内径

`pull-r0`: (1) [nm]  
牵引几何`cylinder`的圆柱外径

`pull-constr-tol`: (1e-6)  
约束牵引的相对约束容差

`pull-start`:

- `no`  
不修改`pull-init`

- `yes`  
将初始构型的质心距离添加到`pull-init`

`pull-print-reference`: (10)

- `no`  
不打印每个牵引坐标中第一组的质心

- `yes`  
打印每个牵引坐标中第一组的质心

`pull-nstxout`: (10)  
所有牵引组质心的输出频率

`pull-nstfout`: (1)  
所有牵引组受力的输出频率

`pull-ngroups`: (1)  
牵引组的数量, 使用时不包括绝对参考组. 牵引组可以在多个牵引坐标中重复使用. 下面只给出了第1组的牵引选项, 对其他组的选项, 只需简单地增加组编号即可.

`pull-ncoords`: (1)  
牵引坐标的数目. 下面只给出了坐标1的牵引选项, 对其他其他坐标的选项, 只需简单地增加组编号即可.

`pull-group1-name`:  
牵引组的名称, 在索引文件或默认组中查找, 以获得涉及的原子.

`pull-group1-weights`:  
可选的相对权重, 原子质量乘以此值给出质心的总权重. 此值应为0, 意味着所有原子的相对权重为1, 或牵引组中原子的数目.

`pull-group1-pbcatom`: (0)  
处理组内周期性边界条件的参考原子(不影响组间PBC的处理). 此选项仅当牵引组的直径超过最短盒矢量长度的一半时才重要. 为了确定质心, 组中所有原子被置于其最接近`pull-group1-pbcatom`的周期性映象. 此值为0时意味着使用中间原子(编号顺序). 此参数不能用于牵引几何`cylinder`. 此值为-1时启用余弦加权, 这对周期性的体系中的一组分子有用, 例如, 水的平板(参考 Engin et al. J. Chem. Phys. B 2010).

`pull-coord1-groups`:  
给出牵引坐标作用的两个组的编号. 第一个编号可以是0, 在这种情况下使用`pull-coord1-origin`的绝对参考. 使用绝对参考时体系不再具有平移不变性, 你应该考虑如何处理质心的运动.

`pull-coord1-origin`: (0.0 0.0 0.0)  
使用绝对参考时牵引的参考位置.

`pull-coord1-vec`: (0.0 0.0 0.0)  
牵引方向. `grompp`会对此矢量进行归一化.

`pull-coord1-init:`: (0.0) [nm]  
t=0时刻的基准距离.

`pull-coord1-rate`: (0) [nm/ps]  
基准位置的变化速率.

`pull-coord1-k`: (0) [kJ mol^-1^ nm^-2^ / kJ mol^-1^ nm^-1^]  
力常数. 对于伞势牵引, 此值为简谐力常数[kJ mol^-1^ nm^-2^]. 对于恒力牵引, 此值为线性势的力常数, 因而为力常数[kJ mol^-1^ nm^-1^]的负值(!).

`pull-coord1-kB`: (pull-k1) [kJ mol^-1^ nm^-2^ / kJ mol^-1^ nm^-1^]  
与`pull-coord1-k`类似, 但用于状态B. 仅当启用`free-energy`时才使用. 力常数为 (1-lambda)*`pull-coord1-k`+lambda*`pull-coord1-kB`.

### 7.3.22 NMR精修

`disre`:

- `no`  
忽略拓扑文件中的距离约束信息

- `simple`  
简单(每分子)的距离约束.

- `ensemble`  
一个模拟盒中分子系综的距离约束. 正常情况下, 需要对多个子体系进行系综平均, 每个系综处于单独的盒子中, 使用`mdrun -multi`提供包含不同坐标和/或速度的`topol0.tpr`, `topol1.tpr`, ... 环境变量`GMX_DISRE_ENSEMBLE_-SIZE`设置每个系综中体系的数目(通常等于`mdrun -multi`的值).

`disre-weighting`:

- `equal` (默认)  
将约束力平分到约束中的所有原子对上

- `conservative`  
约束力为约束势的导数, 将导致原子对的权重为r^-7^. 当`disre-tau`为零时力是守恒的.

`disre-mixed`

- `no`  
计算约束力时使用时间平均的违反

- `yes`  
计算约束力时使用时间平均违反与瞬时违反乘积的平方根

`disre-fc`: (1000) [kJ mol^-1^ nm^-2^]  
距离约束的力常数, 对每个约束乘以一个(可能)不同的因子, 约束在拓扑文件中相互作用的`fac`列给出.

`disre-tau:` (0) [ps]  
进行距离约束平均的时间常数. 零值关闭时间平均.

`nstdisreout`: (100) [步]  
进行时间平均的间隔步数, 也是约束中涉及的所有原子对之间的瞬时距离写入到能量文件的间隔步数(会使能量文件变得非常大)

`orire`:

- `no`  
忽略拓扑文件中的取向约束信息

- `yes`  
使用取向约束, 可以利用`mdrun -multi`进行系综平均

`orire-fc`: (0) [kJ mol]  
取向约束的力常数, 对每个约束乘以一个(可能)不同的权重因子. 可设置为零以获得自由模拟的取向.

`orire-tau`: (0) [ps]  
对取向约束进行时间平均的时间常数. 零值关闭时间平均.

`orire-fitgrp`:  
取向约束的叠合组. 此原子组用于确定体系相对于参考取向的旋转矩阵`R`. 参考取向为第一个子体系的初始构型. 对蛋白质, 主链是合理的选择.

`nstorireout`: (100) [步]  
进行时间平均的间隔步数, 也是所有约束的瞬时取向和分子序张量写入到能量文件的间隔步数(会使能量文件变得非常大)
