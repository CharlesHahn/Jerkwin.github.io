---
 layout: post
 title: GROMACS中文手册第5章：拓扑文件 7-8节
 categories:
 - 科
 tags:
 - GMX
---

# 第五章　拓扑文件

## 5.7 文件格式

### 5.7.1 拓扑文件

拓扑文件是根据GROMACS对分子拓扑的具体说明建立的. 可利用`pdb2gmx`程序生成`*.top`文件. 拓扑文件中所有可能的输入项都列于表 5.4和表 5.5中. 表中还列有: 所有参数的单位, 哪些相互作用可被微扰以用于自由能计算, `grompp`可使用哪些键合相互作用生成排除, `grompp`可将哪些键合相互作用转化为约束.

<table><caption> 表5.4: 拓扑(<code>*.top</code>)文件</caption>
<tr>
<td colspan="6" style="text-align:center;"><h6>参数</h6></td>
</tr>
<tr>
<th style="text-align:center;">相互作用类型</th>
<th style="text-align:center;">指令</th>
<th style="text-align:center;">原子数</th>
<th style="text-align:center;">函数类型</th>
<th style="text-align:center;">参数</th>
<th style="text-align:center;">自由能</th>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>defaults</code></td>
<td colspan="2" style="text-align:center;"></td>
<td style="text-align:center;">非键函数类型; 组合规则<sup>cr</sup>; 生成对(no/yes); fudge LJ(); fudge QQ()</td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>atomtypes</code></td>
<td colspan="2" style="text-align:center;"></td>
<td style="text-align:left;">原子类型; 质量m(u); 电荷q(e); 粒子类型; V<sup>cr</sup>; W<sup>cr</sup></td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td style="text-align:center;"></td>
<td style="text-align:center;"><code>bondtypes</code></td>
<td colspan="4" style="text-align:center;">(参考表 5.5 <code>bonds</code>指令)</td>
</tr>
<tr>
<td style="text-align:center;"></td>
<td style="text-align:center;"><code>pairtypes</code></td>
<td colspan="4" style="text-align:center;">(参考表 5.5 <code>pairs</code>指令)</td>
</tr>
<tr>
<td style="text-align:center;"></td>
<td style="text-align:center;"><code>angletypes</code></td>
<td colspan="4" style="text-align:center;">(参考表 5.5 <code>angles</code>指令)</td>
</tr>
<tr>
<td style="text-align:center;"></td>
<td style="text-align:center;"><code>dihedraltypes</code><sup>*</sup></td>
<td colspan="4" style="text-align:center;">(参考表 5.5 <code>dihedrals</code>指令)</td>
</tr>
<tr>
<td style="text-align:center;"></td>
<td style="text-align:center;"><code>constrainttypes</code></td>
<td colspan="4" style="text-align:center;">(参考表 5.5 <code>constraints</code>指令)</td>
</tr>
<tr>
<td style="text-align:center;">LJ</td>
<td style="text-align:center;"><code>nonbond_params</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">V<sup>cr</sup>; W<sup>cr</sup></td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td style="text-align:center;">Buckingham</td>
<td style="text-align:center;"><code>nonbond_params</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">a(kJ mol<sup>-1</sup>); b(nm<sup>-1</sup>); c6(kJ mol<sup>-1</sup> nm<sup>6</sup>)</td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td colspan="6" style="text-align:center;"><h6>分子定义</h6></td>
</tr>
<tr>
<th style="text-align:center;">相互作用类型</th>
<th style="text-align:center;">指令</th>
<th style="text-align:center;">原子数</th>
<th style="text-align:center;">函数类型</th>
<th style="text-align:center;">参数</th>
<th style="text-align:center;">自由能</th>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>moleculetype</code></td>
<td style="text-align:center;"></td>
<td style="text-align:center;"></td>
<td style="text-align:center;">分子名称; n<sub>ex</sub><sup>nrexcl</sup></td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>atoms</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">原子类型; 残基编号; 残基名称; 原子名称; 电荷组编号; 电荷q(e); 质量m(u)</td>
<td style="text-align:center;">类型, q, m</td>
</tr>
<tr>
<td colspan="6" style="text-align:center;">分子内相互作用和几何构型定义见表 5.5</td>
</tr>
<tr>
<td colspan="6" style="text-align:center;"><h6>系统</h6></td>
</tr>
<tr>
<th style="text-align:center;">相互作用类型</th>
<th style="text-align:center;">指令</th>
<th style="text-align:center;">原子数</th>
<th style="text-align:center;">函数类型</th>
<th style="text-align:center;">参数</th>
<th style="text-align:center;">自由能</th>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>system</code></td>
<td style="text-align:center;"></td>
<td style="text-align:center;"></td>
<td style="text-align:center;">系统名称</td>
<td style="text-align:center;"></td>
</tr>
<tr>
<td style="text-align:center;">必需</td>
<td style="text-align:center;"><code>molecules</code></td>
<td style="text-align:center;"></td>
<td style="text-align:center;"></td>
<td style="text-align:center;">分子名称; 分子数</td>
<td style="text-align:center;"></td>
</tr>
</table>

- 原子数: 对每个指令需要的原子类型的数目
- 函数类型: 要选择的函数类型
- 自由能: 表示自由能计算时这种相互作用的哪些参数可以进行插值
- ^cr^: 组合规则确定LJ参数的类型, 参见5.3.2节
- ^*^: 对`dihedraltypes`可指定4个原子或两个内原子(对异常二面角则设定两个外原子)
- ^nrexcl^: 对非键相互作用, 排除相邻的n~ex~个键
- 对于自由能计算, 在正常参数之后, 类型, 电荷q和质量m或无参数添加到同一行上的拓扑'B'(λ=1).

<table><caption> 表 5.5: <code>[ moleculetype ]</code>指令详解</caption>
<tr>
<th style="text-align:center;">相互作用名称</th>
<th style="text-align:center;">拓扑文件指令</th>
<th style="text-align:center;">原子数<sup>*</sup></th>
<th style="text-align:center;">函数类型<sup>†</sup></th>
<th style="text-align:center;">参数顺序及其单位</th>
<th style="text-align:center;">用于自由能计算?<sup>‡</sup></th>
<th style="text-align:center;">交叉参考(节)</th>
</tr>
<tr>
<td style="text-align:center;">键</td>
<td style="text-align:center;"><code>bonds</code><sup>§,¶</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(b_0\)(nm); \(k_b\) (kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.1</td>
</tr>
<tr>
<td style="text-align:center;">G96键</td>
<td style="text-align:center;"><code>bonds</code><sup>§,¶</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(b_0\)(nm); \(k_b\)(kJ mol<sup>-1</sup> nm<sup>-4</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.1</td>
</tr>
<tr>
<td style="text-align:center;">Morse键</td>
<td style="text-align:center;"><code>bonds</code><sup>§,¶</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">\(b_0\)(nm); \(D\)(kJ mol<sup>-1</sup>); \(\b\)(nm<sup>-1</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.2</td>
</tr>
<tr>
<td style="text-align:center;">立方键</td>
<td style="text-align:center;"><code>bonds</code><sup>§,¶</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">\(b_0\)(nm); \(C_{i&#61;2,3}\)(kJ mol<sup>-1</sup> nm<sup>-i</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.3</td>
</tr>
<tr>
<td style="text-align:center;">连接</td>
<td style="text-align:center;"><code>bonds</code><sup>§</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">5</td>
<td colspan="2" style="text-align:center;"></td>
<td style="text-align:center;">5.4</td>
</tr>
<tr>
<td style="text-align:center;">简谐势</td>
<td style="text-align:center;"><code>bonds</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">6</td>
<td style="text-align:center;">\(b_0\)(nm); \(k_b\) (kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.1, 5.4</td>
</tr>
<tr>
<td style="text-align:center;">FENE键</td>
<td style="text-align:center;"><code>bonds</code><sup>§</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">7</td>
<td style="text-align:center;">\(b_m\)(nm); \(k_b\) (kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.4</td>
</tr>
<tr>
<td style="text-align:center;">表格键</td>
<td style="text-align:center;"><code>bonds</code><sup>§</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">8</td>
<td style="text-align:center;">表号(≥0); \(k\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">\(k\)</td>
<td style="text-align:center;">4.2.14</td>
</tr>
<tr>
<td style="text-align:center;">表格键\(^\lVert\)</td>
<td style="text-align:center;"><code>bonds</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">9</td>
<td style="text-align:center;">表号(≥0); \(k\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">\(k\)</td>
<td style="text-align:center;">4.2.14, 5.4</td>
</tr>
<tr>
<td style="text-align:center;">约束势</td>
<td style="text-align:center;"><code>bonds</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">10</td>
<td style="text-align:center;">下限,上限1,上限2(nm); \(k_{dr}\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.3.5</td>
</tr>
<tr>
<td style="text-align:center;">额外LJ或库仑</td>
<td style="text-align:center;"><code>pairs</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">V<sup>**</sup>; W<sup>**</sup></td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">5.3.4</td>
</tr>
<tr>
<td style="text-align:center;">额外LJ或库仑</td>
<td style="text-align:center;"><code>pairs</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">fudge QQ(); q<sub>i</sub>, q<sub>j</sub>(e); V<sup>**</sup>; W<sup>**</sup></td>
<td style="text-align:center;"></td>
<td style="text-align:center;">5.3.4</td>
</tr>
<tr>
<td style="text-align:center;">额外LJ或库仑</td>
<td style="text-align:center;"><code>pairs_nb</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">q<sub>i</sub>, q<sub>j</sub>(e); V<sup>**</sup>; W<sup>**</sup></td>
<td style="text-align:center;"></td>
<td style="text-align:center;">5.3.4</td>
</tr>
<tr>
<td style="text-align:center;">键角</td>
<td style="text-align:center;"><code>angles</code><sup>¶</sup></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_\q\)(kJ mol<sup>-1</sup> rad<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.5</td>
</tr>
<tr>
<td style="text-align:center;">G96键角</td>
<td style="text-align:center;"><code>angles</code><sup>¶</sup></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_\q\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.6</td>
</tr>
<tr>
<td style="text-align:center;">键-键交叉项</td>
<td style="text-align:center;"><code>angles</code></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">\(r_{1e},r_{2e}\)(nm); \(k_{rr'}\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.9</td>
</tr>
<tr>
<td style="text-align:center;">键-角交叉项</td>
<td style="text-align:center;"><code>angles</code></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">\(r_{1e},r_{2e},r_{3e}\)(nm); \(k_{r\q}\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.10</td>
</tr>
<tr>
<td style="text-align:center;">Urey-Bradley键角</td>
<td style="text-align:center;"><code>angles</code><sup>¶</sup></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">5</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_\q\)(kJ mol<sup>-1</sup> rad<sup>-2</sup>); \(r_{13}\)(nm); </br>\(k_{UB}\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.8</td>
</tr>
<tr>
<td style="text-align:center;">四次键角</td>
<td style="text-align:center;"><code>angles</code><sup>¶</sup></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">6</td>
<td style="text-align:center;">\(\q_0\)(deg); \(C_{i&#61;0,1,2,3,4}\)(kJ mol<sup>-1</sup> rad<sup>-i</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.11</td>
</tr>
<tr>
<td style="text-align:center;">表格角</td>
<td style="text-align:center;"><code>angles</code></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">8</td>
<td style="text-align:center;">表号(≥0); \(k\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">\(k\)</td>
<td style="text-align:center;">4.2.14</td>
</tr>
<tr>
<td style="text-align:center;">限制弯曲势</td>
<td style="text-align:center;"><code>angles</code></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">10</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_\q\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.7</td>
</tr>
<tr>
<td style="text-align:center;">正常二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(\f_s\)(deg); \(k_\f\)(kJ mol<sup>-1</sup>); 多重数</td>
<td style="text-align:center;">\(\f,k\)</td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">异常二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(\x_0\)(deg); \(k_\x\)(kJ mol<sup>-1</sup> rad<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.12</td>
</tr>
<tr>
<td style="text-align:center;">Ryckaert-Bellemans二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">\(C_0, C_1, C_2, C_3, C_4, C_5\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">周期异常二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">\(\f_s\)(deg); \(k_\f\)(kJ mol<sup>-1</sup>); 多重数</td>
<td style="text-align:center;">\(\f,k\)</td>
<td style="text-align:center;">4.2.12</td>
</tr>
<tr>
<td style="text-align:center;">傅立叶二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">5</td>
<td style="text-align:center;">\(C_0, C_1, C_2, C_3, C_4\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">表格二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">8</td>
<td style="text-align:center;">表号(≥0); \(k\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;">\(k\)</td>
<td style="text-align:center;">4.2.14</td>
</tr>
<tr>
<td style="text-align:center;">正常二面角(多重)</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">9</td>
<td style="text-align:center;">\(\f_s\)(deg); \(k_\f\)(kJ mol<sup>-1</sup>); 多重数</td>
<td style="text-align:center;">\(\f,k\)</td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">限制二面角</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">11</td>
<td style="text-align:center;">\(\f_0\)(deg); \(k_\f\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">结合弯区扭转势</td>
<td style="text-align:center;"><code>dihedrals</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">10</td>
<td style="text-align:center;">\(a_0, a_1, a_2, a_3, a_4\)(kJ mol<sup>-1</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.2.13</td>
</tr>
<tr>
<td style="text-align:center;">排除</td>
<td style="text-align:center;"><code>exclusions</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">一个或多个原子索引号</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">5.4</td>
</tr>
<tr>
<td style="text-align:center;">约束</td>
<td style="text-align:center;"><code>constraints</code><sup>§</sup></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(b_0\)(nm)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.5, 5.5</td>
</tr>
<tr>
<td style="text-align:center;">约束\(^\lVert\)</td>
<td style="text-align:center;"><code>constraints</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(b_0\)(nm)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.5, 5.5, 5.4</td>
</tr>
<tr>
<td style="text-align:center;">SETTLE</td>
<td style="text-align:center;"><code>settles</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(d_{\text{oh}}, d_{\text{HH}}\)(nm)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">3.6.1, 5.5</td>
</tr>
<tr>
<td style="text-align:center;">二体虚拟站点</td>
<td style="text-align:center;"><code>virtual_sites2</code></td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(a\)()</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">三体虚拟站点</td>
<td style="text-align:center;"><code>virtual_sites3</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(a,b\)()</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">三体虚拟站点(fd)</td>
<td style="text-align:center;"><code>virtual_sites3</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(a\)(); \(d\)(nm)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">三体虚拟站点(fad)</td>
<td style="text-align:center;"><code>virtual_sites3</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">\(\q\)(deg); \(d\)(nm)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">三体虚拟站点(out)</td>
<td style="text-align:center;"><code>virtual_sites3</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">\(a,b\)(); \(c\)(nm<sup>-1</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">四体虚拟站点(fdn)</td>
<td style="text-align:center;"><code>virtual_sites4</code></td>
<td style="text-align:center;">5</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(a,b\)(); \(c\)(nm)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">N体虚拟站点(COG)</td>
<td style="text-align:center;"><code>virtual_sitesn</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">一个或多个构建原子索引号</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">N体虚拟站点(COM)</td>
<td style="text-align:center;"><code>virtual_sitesn</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">一个或多个构建原子索引号</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">N体虚拟站点(COW)</td>
<td style="text-align:center;"><code>virtual_sitesn</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">3</td>
<td style="text-align:center;">一对或多对构建原子的索引号与权重</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.7</td>
</tr>
<tr>
<td style="text-align:center;">位置约束</td>
<td style="text-align:center;"><code>position_restraints</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(k_x,k_y,k_z\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.3.1</td>
</tr>
<tr>
<td style="text-align:center;">平底位置约束</td>
<td style="text-align:center;"><code>position_restraints</code></td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">\(g,r\)(nm), \(k\)(kJ mol<sup>-1</sup> nm<sup>-2</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.3.2</td>
</tr>
<tr>
<td style="text-align:center;">距离约束</td>
<td style="text-align:center;"><code>distance_restraints</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">类型; 标签; 下限, 上限1, 上限2(nm); 权重()</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.3.5</td>
</tr>
<tr>
<td style="text-align:center;">二面角约束</td>
<td style="text-align:center;"><code>dihedral_restraints</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(\f_0\)(deg); \(\D\f\)(deg);</td>
<td style="text-align:center;">所有</td>
<td style="text-align:center;">4.3.4</td>
</tr>
<tr>
<td style="text-align:center;">方向约束</td>
<td style="text-align:center;"><code>orientation_restraints</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">exp.; 标签; \(\a\); \(c\)(U nm<sup>\(\a\)</sup>); obs.(U); 权重(U<sup>-1</sup>)</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">4.3.6</td>
</tr>
<tr>
<td style="text-align:center;">角度约束</td>
<td style="text-align:center;"><code>angle_restraints</code></td>
<td style="text-align:center;">4</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_c\)(kJ mol<sup>-1</sup>); 多重数</td>
<td style="text-align:center;">\(\q,k\)</td>
<td style="text-align:center;">4.3.3</td>
</tr>
<tr>
<td style="text-align:center;">角度约束(z)</td>
<td style="text-align:center;"><code>angle_restraints_z</code></td>
<td style="text-align:center;">2</td>
<td style="text-align:center;">1</td>
<td style="text-align:center;">\(\q_0\)(deg); \(k_c\)(kJ mol<sup>-1</sup>); 多重数</td>
<td style="text-align:center;">\(\q,k\)</td>
<td style="text-align:center;">4.3.3</td>
</tr>
</table>

- *: 指令所需的原子数目
- †: 用于选择的函数类型编号
- ‡: 表示自由能计算时这种相互作用的哪些参数可以进行插值
- §: `grompp`会利用这种相互作用类型产生排除
- ¶: `grompp`会将这种相互作用类型转换为约束
- ** : 组合规则确定LJ参数的类型, 参见5.3.2节
- $\lVert$: 无连接, 因此不会为这种相互作用产生排除

文件布局说明:

- 分号(`;`)和换行符之间为注释
- 忽略`\`后的换行符, 即`\`为续行符
- `[` 和 `]` 之间为指令
- 拓扑等级(必须遵循)包含三个层次:

	- 参数级别, 定义了一些力场的设定(见表 5.4)
	- 分子级别, 应包含一个或多个分子的定义(见表 5.5)
	- 体系级别, 只包含体系的特定信息(`[ system ]`及`[ molecules ]`)

- 每一项应用空格或制表符分格, 而不是逗号
- 分子中的原子应从1开始连续编号
- 相同电荷组中的原子必须连续列出
- 文件只解析一次, 这意味着不会处理向前引用: 每一项在使用前必须进行定义
- 可以从键生成排除, 或手动覆盖
- 可以从原子类型生成键合力的类型, 或对每条键覆盖
- 在同一个原子上可以使用多个相同类型的键合相互作用
- 强烈推荐使用描述性的注释行和空行
- 自GROMACS 3.1.3版本开始, 参数级别的所有指令可使用多次, 并且没有顺序限制, 除了在其它参数定义中, 原子类型在使用前需要进行定义
- 对相同的原子类型组合, 如果某个相互作用的参数被定义了多次, 会使用最后定义的参数; 自GROMACS 3.1.3版本开始, 参数若存在不同值的重定义, `grompp`会生成警告
- 在`[ moleculetype ]`之前使用`[ atoms ]`, `[ bonds ]`, `[ pairs ]`, `[ angles ]`等指令毫无意义, 会导致警告
- 在`[ system ]`之前使用`[ molecules ]`指令毫无意义, 会导致警告
- 在`[ system ]`之后唯一可以使用的指令是`[ molecules ]`
- 在`[ ]`中使用未知的字符串会导致直到下一个指令的所有数据被忽略, 并产生警告

下面是拓扑文件的一个例子, `urea.top`:

	;
	;       Example topology file
	;
	; The force-field files to be included
	#include "amber99.ff/forcefield.itp"

	[ moleculetype ]
	; name nrexcl
	Urea        3

	[ atoms ]
	   1  C  1  URE    C    1     0.880229    12.01000    ; amber C type
	   2  O  1  URE    O    2    -0.613359    16.00000    ; amber O type
	   3  N  1  URE   N1    3    -0.923545    14.01000    ; amber N type
	   4  H  1  URE  H11    4     0.395055     1.00800    ; amber H type
	   5  H  1  URE  H12    5     0.395055     1.00800    ; amber H type
	   6  N  1  URE   N2    6    -0.923545    14.01000    ; amber N type
	   7  H  1  URE  H21    7     0.395055     1.00800    ; amber H type
	   8  H  1  URE  H22    8     0.395055     1.00800    ; amber H type

	[ bonds ]
		1 2
		1 3
		1 6
		3 4
		3 5
		6 7
		6 8

	[ dihedrals ]
	;   ai    aj    ak    al    funct definition
		 2     1     3     4      9
		 2     1     3     5      9
		 2     1     6     7      9
		 2     1     6     8      9
		 3     1     6     7      9
		 3     1     6     8      9
		 6     1     3     4      9
		 6     1     3     5      9

	[ dihedrals ]
		 3     6     1     2      4
		 1     4     3     5      4
		 1     7     6     8      4

	[ position_restraints ]
	; you wouldn't normally use this for a molecule like Urea,
	; but we include it here for didactic purposes
	; ai    funct    fc
	   1      1     1000  1000  1000    ; Restrain to a point
	   2      1     1000     0  1000    ; Restrain to a line (Y-axis)
	   3      1     1000     0     0    ; Restrain to a plane (Y-Z-plane)

	[ dihedral_restraints ]
	; ai  aj  ak  al  type  label  phi  dphi  kfac  power
	   3   6   1   2     1      1  180     0     1     2
	   1   4   3   5     1      1  180     0     1     2

	; Include TIP3P water topology
	#include "amber99/tip3p.itp"

	[ system ]
	Urea in Water

	[ molecules ]
	;molecule name    nr.
	Urea              1
	SOL               1000

下面是此文件的解释说明.

`#include "amber99.ff/forcefield.itp"`: 包含你正使用的力场的信息, 包括键和非键参数. 本例使用了AMBER99力场, 但你进行模拟时可使用不同的力场. `grompp`会自动找到这个文件并复制粘贴它的内容. 你可以在`share/top/amber99.ff/forcefield.itp`文件中看到它的内容

	#define _FF_AMBER
	#define _FF_AMBER99

	[ defaults ]
	; nbfunc    comb-rule    gen-pairs    fudgeLJ    fudgeQQ
	1           2            yes          0.5        0.8333

	#include "ffnonbonded.itp"
	#include "ffbonded.itp"
	#include "gbsa.itp"

两个`#define`语句设置了条件, 这样拓扑文件后面的部分可以知道使用了AMBER 99力场.

`[ defaults ]`:

- `nbfunc`为非键函数类型, 取1(Lennard-Jones)或2(Buckingham)
- `comb-rule`为组合规则的编号(参见5.3.2节).
- `gen-pairs`用于对的生成. 默认为'no', 即得到对类型列表的1-4的参数. 当列表中不存在参数时, 会导致致命错误并停止运行. 设置为'yes'会根据使用`fudgeLJ`的正常Lennard-Jones参数, 生成不存在于配对列表中的1-4参数
- `fudgeLJ`为Lennard-Jones 1-4相互作用的修正因子, 默认为1
- `fudgeQQ`为静电1-4相互作用的修正因子, 默认为1
- N为6-N势中排斥项的次数(只用于非键Lennard-Jones), 自GROMACS 4.5版本开始, `mdrun`会读取和使用N, 当N不等于12时, 使用表格相互作用函数(在旧版本中, 你必须使用用户自定义的表格相互作用).

__注意__, `gen-pairs`, `fudgeLJ`, `fudgeQQ`和N是可选的. 仅当`gen-pairs`被设置为'yes'时才会使用`fudgeLJ`, 而总会使用`fudgeQQ`. 然而, 如果你想指定N, 你也需要给出其他参数的值.

后面的其他一些`#include`语句用于添加描述力场其余部分所需的大量数据. 我们将跳过这些并回到`urea.top`文件. 在那里, 我们会看到

`[ moleculetype ]`: 定义此`*.top`文件中分子的名称, nrexcl=3代表排除不远于三条键的原子之间的非键相互作用.

` [ atoms ]`: 定义分子, 其中`nr`和`type`是固定的, 其余的由用户自定义. 因此`atom`可以随意命名, `cgnr`可大可小(如果可能, 一个电荷组的总电荷应为零), 这里的电荷也可以更改.

`[ bonds ]`: 不注释.

`[ pairs ]`: LJ和库仑的1-4相互作用

`[ angles ]`: 不注释.

`[ dihedrals ]`: 在此情况下, 有9个正常二面角(funct=1), 3个异常二面角(funct=4), 没有Ryckaert-Bellemans型的二面角. 如果你想在拓扑文件中包含Ryckaert-Bellemans型的二面角, 请遵照下列的示例(例如, 对癸烷):

[ dihedrals ]
; ai     aj     ak     al     funct     c0     c1     c2
   1      2      3      4        3
   2      3      4      5        3

在烷烃势能的原始实现中[128], 没有使用1-4相互作用, 这意味着为了使用这个特定的力场, 你需要从拓扑文件的`[ pairs ]`段中移除1-4相互作用. 对大多数的现代力场, 如OPLS/AA或Amber, 其规则是不同的, Ryckaert-Bellemans势是作为余弦序列与1-4相互作用一起使用的.

`[ position_restraints ]`: 利用简谐势将选中的粒子约束在参考位置(参见4.3.1节). `grompp`会从由单独的坐标文件中读取参考位置.

`[ dihedral_restraints ]`: 将选定的二面角约束在参考值. 二面角约束的实现方法参见本手册4.3.4节的论述. `[ dihedral_restraints ]`指令中设定的参数如下:

- `type` 只有一个可能的值, 1
- `label` 未使用, 并被从代码删除.

- `phi` 为本手册方程4.84和4.85中的 $\f_0$ 值.
- `dphi` 为本手册方程4.85中的 $\D \f$ 值.
- `kfac` 类似于距离约束中的`fac`, 是力常数的修正因子. 通过它, 可以利用不同的力常数维持不同的约束.
- `power` 未使用, 并被从代码删除.

`#include "tip3p.itp"`: 包括一个已经构建好的拓扑文件(参见5.7.2节).

`[ system ]`: 体系的标题, 用户自定义

`[ molecules ]`: 定义体系中分子(亚分子)的总数, 这些分子已经在此`*.top`中进行了定义. 在这个示例文件中, 它代表1个尿素分子溶于1000个水分子中. 分子类型SOL是在`tip3p.itp`文件中定义的. 这里的每个名称必须对应于拓扑文件前面的`[ moleculetype ]`中给出的名称. 分子类型块的顺序, 这些分子的数目必须与坐标文件匹配, 坐标文件和拓扑文件会一起提供给`grompp`. 分子块不需要连续, 但某些工具(如`genion`)可能只对一个特定分子类型的第一或最后一块起作用. 另外, 这些块与组的定义无关(参见3.3节和8.1节).

### 5.7.2 Molecule.itp文件

如果你构建了一个拓扑文件并且经常使用(像水分子, 已经构建好的`tip3p.itp`), 将它做成`molecule.itp`文件更好一些. 此文件中只列出了一个特定分子的信息, 你可以在多个体系中重用`[ moleculetype ]`, 而无需重新调用`pdb2gmx`或手动复制粘贴. 例子`urea.itp`如下:

	[ moleculetype ]
	; molname nrexcl
	URE 3

	[ atoms ]
	   1  C  1  URE    C    1  0.880229  12.01000  ; amber C type
	...
	   8  H  1  URE  H22    8  0.395055   1.00800  ; amber H type

	[ bonds ]
		1 2
	...
		6 8

	[ dihedrals ]
	;   ai  aj  ak  al  funct  definition
		 2   1   3   4    9
	...
		 6   1   3   5    9

	[ dihedrals ]
		 3   6   1   2    4
		 1   4   3   5    4
		 1   7   6   8    4

使用`*.itp`文件会使`*.top`文件明显变短:

	;       Example topology file
	;
	; The force field files to be included
	#include "amber99.ff/forcefield.itp"

	#include "urea.itp"

	; Include TIP3P water topology
	#include "amber99/tip3p.itp"

	[ system ]
	Urea in Water

	[ molecules ]
	;molecule name    nr.
	Urea              1
	SOL               1000

### 5.7.3 ifdef语句

GROMACS有一个非常强大的功能, 你可以在`*.top`文件中使用`#ifdef`语句. 通过使用这条语句以及相关的`#define`语句, 像在前面的`amber99.ff/forcefield.itp`文件中那样, 在同一个`*.top`文件中可以为分子使用不同的参数. 下面给出TFE的一个例子, 其中的一个选项对原子使用了不同的电荷: De Loof等人给出的电荷[129]或Van Buuren和Berendsen给出的电荷[130]. 实际上, 你可以使用C预处理器`cpp`的许多功能, 因为`grompp`包含了类似的预处理函数以扫描文件. 使用`#ifdef`选项的方式如下:

- 在`*.mdp`文件(包含`grompp`输入参数)中使用选项`define = -DDeLoof`, 或在`*.top`中早些使用`#define DeLoof`, 并且

- 将`#ifdef`语句放在`*.top`中, 如所示:

		...

		[ atoms ]
		; nr type resnr residu atom cgnr charge mass
		#ifdef DeLoof
		; Use Charges from DeLoof
		   1        C        1        TFE    C    1     0.74
		   2        F        1        TFE    F    1    -0.25
		   3        F        1        TFE    F    1    -0.25
		   4        F        1        TFE    F    1    -0.25
		   5      CH2        1        TFE  CH2    1     0.25
		   6       OA        1        TFE   OA    1    -0.65
		   7       HO        1        TFE   HO    1     0.41
		#else
		; Use Charges from VanBuuren
		   1        C        1        TFE    C    1      0.59
		   2        F        1        TFE    F    1     -0.2
		   3        F        1        TFE    F    1     -0.2
		   4        F        1        TFE    F    1     -0.2
		   5      CH2        1        TFE  CH2    1      0.26
		   6       OA        1        TFE   OA    1     -0.55
		   7       HO        1        TFE   HO    1      0.3
		#endif

		[ bonds ]
		;  ai    aj  funct           c0           c1
			6     7      1 1.000000e-01 3.138000e+05
			1     2      1 1.360000e-01 4.184000e+05
			1     3      1 1.360000e-01 4.184000e+05
			1     4      1 1.360000e-01 4.184000e+05
			1     5      1 1.530000e-01 3.347000e+05
			5     6      1 1.430000e-01 3.347000e+05
		...

`pdb2gmx`使用这个机制来实现可选的位置约束(4.3.1节), 具体是通过使用`#include`包含`.itp`文件, 而此文件的只有设置了特定的`#define`(并且拼写正确!)时才有意义.

### 5.7.4 用于自由能计算的拓扑文件

两个体系A和B之间的自由能差值, 其计算方法见3.12节的论述. 描述体系A和B的拓扑具有相同数目的分子, 分子的原子数也相同. 通过在`[ atoms ]`指令下添加B参数, 可以对质量和非键相互作用进行微扰. 键合相互作用的微扰可以通过添加B参数到键合类型或键合相互作用来完成. 能够进行微扰的参数列于表 5.4和表 5.5. 相互作用的 $\l$ 依赖性见4.5节的论述. 使用的键参数(位于定义键相互作用的行, 或通过对键合类型列表的原子类型进行查找得到)在表 5.6中进行了解释. 大多数情况下, 处理方式都很直观. 当键合相互作用中A和B的原子类型不完全相同, 且B状态的参数不存在时, 无论是位于行还是键合类型, `grompp`都会使用A状态的参数, 并发出警告. 对自由能计算, 拓扑B($\l= 1$)的所有参数或者添加在同一行, 或者不添加, 添加时位于正常参数之后, 顺序与正常参数相同. 自GROMACS 4.6版本起, 如果 $\l$ 被视为矢量, 那么`bonded-lambdas`分量控制所有未明确标记为约束的键合项. 约束项通过`restraint-lambdas`分量控制.

<table><caption> 表 5.6: 用于自由能拓扑的键合参数, 位于定义键合相互作用的行, 或基于原子类型在键类型中查找. A和B表示分别用于状态A和B的参数, +和-表示拓扑中(不)存在的参数, x表示存在没有影响.</caption>
<tr>
<th style="text-align:center;">B状态与A状态的原子类型完全相同?</th>
<th style="text-align:center;">行参数</br>A　B</th>
<th style="text-align:center;">A原子类型的键合类型参数</br>A　B</th>
<th style="text-align:center;">B原子类型的键合类型参数</br> A　B</th>
<th style="text-align:center;">信息</th>
</tr>
<tr>
<td style="text-align:center;">yes</td>
<td style="text-align:center;">+AB　-</br>+A　+B</br>-　-</br>-　-</br>-　-</td>
<td style="text-align:center;">x　x</br>x　x</br>-　-</br>+AB　-</br>+A　+B</td>
<td style="text-align:center;"></td>
<td style="text-align:center;">错误</td>
</tr>
<tr>
<td style="text-align:center;">no</td>
<td style="text-align:center;">+AB　-</br>+A　+B</br>-　-</br>-　-</br>-　-</br>-　-</br>-　-</td>
<td style="text-align:center;">x　x</br>x　x</br>-　-</br>+AB　-</br>+A　+B</br>+A　x</br>+A　x</td>
<td style="text-align:center;">x　x</br>x　x</br>x　x</br>-　-</br>-　-</br>+B　-</br>+　+B</td>
<td style="text-align:center;">警告</br>　</br>错误</br>警告</br>警告</br>　</br>　</td>
</tr>
</table>

下面是一个拓扑文件的例子, 将200个丙醇分子转变为200个戊烷分子, 使用了GROMOS-96力场.

	; Include force field parameters
	#include "gromos43a1.ff/forcefield.itp"
	[ moleculetype ]
	; Name     nrexcl
	PropPent   3

	[ atoms ]
	; nr    type  resnr  residue  atom  cgnr  charge    mass    typeB   chargeB   massB
	  1       H     1      PROP     PH     1   0.398    1.008    CH3       0.0   15.035
	  2      OA     1      PROP     PO     1  -0.548  15.9994    CH2       0.0   14.027
	  3     CH2     1      PROP    PC1     1   0.150   14.027    CH2       0.0   14.027
	  4     CH2     1      PROP    PC2     2   0.000   14.027
	  5     CH3     1      PROP    PC3     2   0.000   15.035

	[ bonds ]
	; ai    aj    funct    par_A    par_B
	   1     2        2    gb_1     gb_26
	   2     3        2    gb_17    gb_26
	   3     4        2    gb_26    gb_26
	   4     5        2    gb_26

	[ pairs ]
	; ai    aj     funct
	   1     4         1
	   2     5         1

	[ angles ]
	; ai    aj    ak    funct    par_A    par_B
	   1     2     3        2    ga_11    ga_14
	   2     3     4        2    ga_14    ga_14
	   3     4     5        2    ga_14    ga_14

	[ dihedrals ]
	; ai    aj    ak    al    funct    par_A    par_B
	   1     2     3     4        1    gd_12    gd_17
	   2     3     4     5        1    gd_17    gd_17

	[ system ]
	; Name
	Propanol to Pentane

	[ molecules ]
	; Compound    #mols
	PropPent      200

未微扰的`PC2`和`PC3`原子不需要指定B状态参数, 因为所用B参数将从A参数复制得来. 原子间不微扰的键合相互作用不需要指定B参数, 如示例拓扑中的最后一条键. 使用OPLS/AA力场的拓扑根本不需要键合参数, 因为A和B参数都由原子类型决定. 涉及一个或两个微扰原子的非键相互作用将使用自由能微扰函数形式, 两个非微扰原子间的非键相互作用使用正常的函数形式. 这意味着, 例如, 当只对粒子的电荷进行微扰时, 若lambda不等于0或1, 其Lennard-Jones相互作用也会受到影响.

__注意__, 此拓扑文件使用了GROMOS-96力场, 其中的键合相互作用不是由原子类型决定的. 键合相互作用的字符串由C预处理器转换而来. 力场参数文件包含这样的行:

	#define  gb_26    0.1530    7.1500e+06

	#define  gd_17    0.000     5.86         3

### 5.7.5 约束力

一个分子中两个原子之间的约束力, 可以使用自由能微扰代码进行计算, 计算时在两个原子之间添加约束, 约束对拓扑A和B具有不同长度. 当B的长度比A大1 nm时, lambda保持为零, 哈密顿量对lambda的导数就是约束力. 对分子之间的约束, 可以使用拉扯代码, 参见6.4节. 下面是一个具体的例子, 通过组合两个甲烷成一个"分子", 计算水中的两个甲烷分子距离0.7 nm时的约束力. __注意__, GROMACS中"分子"的定义不一定对应于分子的化学定义. 在GROMACS中, 一个"分子"可被定义为希望同时考虑的任意一组原子. 添加的约束函数类型为2, 意味着它不被用于生成排除(参见5.4节). 注意约束自由能项被包含在导数项中, 并且具体被包含在`bonded-lambdas`部分中. 然而, 改变约束的自由能 __没有__ 被包含在用于BAR和MBAR的势能差值中, 因为这需要对每个约束分量重新计算能量. 我们计划在以后的版本中实现此功能.

	; Include force-field parameters
	#include "gromos43a1.ff/forcefield.itp"

	[ moleculetype ]
	; Name           nrexcl
	Methanes              1

	[ atoms ]
	; nr    type    resnr    residu    atom cgnr charge    mass
	   1     CH4      1       CH4       C1    1      0    16.043
	   2     CH4      1       CH4       C2    2      0    16.043
	[ constraints ]
	; ai      aj  funct    length_A    length_B
	   1       2      2         0.7         1.7

	#include "gromos43a1.ff/spc.itp"
	[ system ]
	; Name
	Methanes in Water

	[ molecules ]
	; Compound    #mols
	Methanes          1
	SOL            2002

### 5.7.6 坐标文件

扩展名为`.gro`的文件包含了GROMOS-87格式的分子结构. 这种文件的一个示例片段如下:

	MD of 2 waters, reformat step, PA aug-91
	    6
	    1WATER  OW1    1   0.126   1.624   1.679   0.1227  -0.0580   0.0434
	    1WATER  HW2    2   0.190   1.661   1.747   0.8085   0.3191  -0.7791
	    1WATER  HW3    3   0.177   1.568   1.613  -0.9045  -2.6469   1.3180
	    2WATER  OW1    4   1.275   0.053   0.622   0.2519   0.3140  -0.1734
	    2WATER  HW2    5   1.337   0.002   0.680  -1.0641  -1.1349   0.0257
	    2WATER  HW3    6   1.326   0.120   0.568   1.9427  -0.8216  -0.0244
	   1.82060 1.82060 1.82060

格式是固定, 即, 所有列的位置都固定. 如果你想在自己的程序中读取这样的文件, 而不使用GROMACS库, 你可以使用以下格式:

__C格式__:  `"%5i%5s%5s%5i%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f"`

或更准确一点, 包含标题等内容, 应该像这样:

	"%s\n", Title
	"%5d\n", natoms
	for (i=0; (i<natoms); i++) {
	  "%5d%-5s%5s%5d%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f\n",
	  residuenr, residuename, atomname, atomnr, x, y, z, vx, vy, vz
	}
	"%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f\n",
	  box[X][X], box[Y][Y], box[Z][Z],
	  box[X][Y], box[X][Z], box[Y][X], box[Y][Z], box[Z][X], box[Z][Y]

__Fortran格式__: `(i5, 2a5, i5, 3f8.3, 3f8.4)`

因此`confin.gro`是GROMACS坐标文件, 几乎与GROMOS-87文件(对GROMOS用户: 当使用`ntx=7`时)相同. 唯一的区别是, GROMACS对盒子使用了张量, 而不是向量.

## 5.8 力场的组织

### 5.8.1 力场文件

默认提供了许多力场, 并根据`<name>.ff`目录的存在进行检测, 位于`$GMXLIB/share/gromacs/top`的子目录和/或工作目录中. `pdb2gmx`会打印出力场文件的位置信息, 因此你可以很容易地知道调用了哪个版本的力场, 以防你在一个或另一个位置进行了修改. GROMACS包含了以下力场:

- AMBER03蛋白质, 核酸 AMBER94(Duan et al., _J. Comp. Chem._ 24, 1999-2012, __2003__)
- AMBER94力场(Cornell et al., _JACS_ 117, 5179-5197, __1995__)
- AMBER96蛋白质, 核酸AMBER94(Kollman et al., _Acc. Chem. Res._ 29, 461-469, __1996__)
- AMBER99蛋白质, 核酸AMBER94((Wang et al., _J. Comp. Chem. 21_, 1049-1074, __2000__)
- AMBER99SB蛋白质, 核酸AMBER94(Hornak et al., _Proteins_ 65, 712-725, __2006__)
- AMBER99SB-ILDN蛋白质, 核酸AMBER94(Lindorff-Larsen et al., _Proteins 78_, 1950-58, __2010__)
- AMBERGS力场(Garcia & Sanbonmatsu, _PNAS_ 99, 2782-2787, __2002__)
- CHARMM27全原子力场(CHARM22与CMAP的蛋白质力场)
- GROMOS96 43a1力场
- GROMOS96 43a2力场(改进了烷烃二面角)
- GROMOS96 45a3力场((Schuler _JCC_ __2001__ 22 1205)
- GROMOS96 53a5力场( _JCC_ __2004__ vol 25 pag 1656)
- GROMOS96 53a6力场( _JCC_ __2004__ vol 25 pag 1656)
- GROMOS96 54a7力场( _Eur. Biophys. J._ ( __2011__ ), 40, 843-856, DOI: 10.1007/s00249-011-0700-9)
- OPLS-AA/L全原子力场(2001氨基酸二面角)

力场被包含在拓扑文件的开始, 使用`#include`语句, 后面跟着`<name>.ff/forcefield.itp`. 此语句包含力场文件, 反过来, 被包含的力场文件也可包含其它力场文件. 所有的力场以同样方式进行组织. 力场的一个例子`amber99.ff/forcefield.itp`见5.7.1节.

对每个力场, 有一些文件只被`pdb2gmx`使用. 它们是: 残基数据库(`.rtp`, 参见5.6.1节), 氢数据库(`.hdb`, 参见5.6.4节), 两个末端数据库(`.n.tdb`和`.c.tdb`, 参见5.6.5节), 只包含质量的原子类型数据库(`.atp`, 参见5.2.1节). 其他可选的文件参见5.6节的论述.

### 5.8.2 改变力场参数

如果你想更改分子中少量的键相互作用的参数, 最容易的方法是, 直接在`*.top`文件`[ moleculetype ]`段(参见5.7.1节的格式和单位说明)的键相互作用的定义之后输入参数. 如果想更改一种相互作用所有实例中的参数, 你可以在力场文件更改, 或者在包含力场之后添加一个新的`[ ???types ]`段. 如果一种相互作用参数被定义了多次, 会使用最后的定义. 对GROMACS 3.1.3版本, 当使用不同的值重定义参数时, 会导致警告. 建议不要更改原子类型的Lennard-Jones参数, 因为在GROMOS力场中一些原子类型组合的Lennard-Jones参数并不是根据标准组合规则生成的. 这些组合(以及其他可能遵循组合规则的)在`[ nonbond_params ]`段进行定义, 更改原子类型的Lennard-Jones参数对这些组合没有影响.

### 5.8.3 添加原子类型

对GROMACS 3.1.3版本, 在包含正常力场之后, 可以使用额外的`[ atomtypes ]`段添加原子类型. 在新的原子类型定义之后, 可以定义另外的非键参数和对参数. 对3.1.3版本以前的GROMACS, 新的原子类型需要添加到力场文件的`[ atomtypes ]`段, 因为在最后的`[ atomtypes ]`段之上的所有非键参数都会使用标准的组合规则覆盖.
