---
 layout: post
 title: GROMACS中文手册第5章：拓扑文件 6节
 categories:
 - 科
 tags:
 - GMX
---

# 第五章　拓扑文件

## 5.6 `pdb2gmx`输入文件

GROMACS的`pdb2gmx`程序可以根据输入的坐标文件产生拓扑文件, 它支持几种不同格式的坐标文件, 但`*.pdb`是最常用的(也因此程序名称为`pdb2gmx`). `pdb2gmx`程序运行时会在GROMACS `share/top`目录的子目录和你的工作目录中搜索力场, 并根据扩展名为`.ff`的目录中的`forcefield.itp`文件识别力场. 目录中可能存在`forcefield.doc`文件, 如果存在, `pbd2gmx`会将此文件的第一行作为力场的简单描述显示给用户, 以帮助用户选择力场. 否则, 用户可以使用`pdb2gmx`的命令行参数`-ff xxx`来选择力场, 所选的力场将位于`xxx.ff`目录. 搜索力场时, `pdb2gmx`会首先搜索工作目录, 然后再搜索GROMACS的`share/top`目录, 并使用找到的第一个匹配`xxx.ff`的目录.

`pdb2gmx`会读入两个通用文件: 位于力场目录的原子类型文件(扩展名为`.atp`, 参见5.2.1节), 位于工作目录或GROMACS `share/top`目录的`residuetypes.dat`文件. `residuetypes.dat`文件决定了哪些残基名称将被视为蛋白质, DNA, RNA, 水和离子.

对不同类型的分子, `pdb2gmx`可以读入一个或多个数据库及拓扑信息. 属于同一个数据库的一组文件应具有相同的基准名称(basename), 基准名称最好能够对分子类型有所说明(如, 氨基酸, rna, dna). 可能的文件如下:

- `<basename>.rtp`
- `<basename>.r2b` (可选)
- `<basename>.arn` (可选)
- `<basename>.hdb` (可选)
- `<basename>.n.tdb` (可选)
- `<basename>.c.tdb` (可选)

只有包含了构建单元拓扑信息的`.rtp`文件是必需的, 来自于其他文件的信息只用于具有相同基准名的`.rtp`文件中的构建单元. 通过在工作目录中放置具有相同基准名的额外文件, 用户也可以为力场添加新的构建单元. 默认只能定义一个额外的构建单元, 但使用`-rtpo`选项调用`pdb2gmx`程序时, 可以使用本地文件中的构建单元来代替力场中默认的构建单元.

---

### 5.6.1 残基数据库

残基数据库文件的扩展名为`.rtp`. 这个文件原本包含蛋白质的构建单元(氨基酸), 是GROMACS对GROMOS `rt37c4.dat`文件的解释说明, 因此残基数据库文件包含常用构建单元的信息(键, 电荷, 电荷组, 异常二面角). 最好 __不__ 要更改这个文件, 因为它是`pdb2gmx`的标准输入. 但如果确实需要修改, 请修改工作目录中的`*.top`文件(参见5.7.1节), 或`.rtp`文件, 像5.6节解释的那样. 通过直接包含`*.itp`拓扑文件定义一个新的小分子的拓扑可能更容易一些, 具体作法将在5.7.2节讨论. 当添加新的蛋白质残基到数据库中时, 别忘了将残基名称添加到`residuetypes.dat`文件中, 这样`grompp`, `make_ndx`和分析程序才能将残基识别为蛋白质残基(参见8.1.1节).

`.rtp`文件只会被`pdb2gmx`程序使用. 如前面提到的, `pdb2gmx`程序仅仅从`.rtp`数据库中读入键, 原子电荷, 电荷组和异常二面角这些额外信息, 其余的信息是从坐标输入文件读入的. 一些蛋白质的坐标文件中包含非标准氨基酸. 你必须为这些"陌生"残基创建构建单元, 否则你将无法得到`*.top'文件. 对坐标文件中的一些分子, 如配体, 多原子离子, 晶格化溶剂分子等, 也是一样. 残基数据库可以根据以下方法创建:

	[ bondedtypes ] ; mandatory 必需
	; bonds    angles    dihedrals    impropers
	     1         1            1            2 ; mandatory 必需

	[ GLY ] ; mandatory 必需

	[ atoms ] ; mandatory 必需
	; name    type    charge    chargegroup
	     N       N    -0.280       0
	     H       H     0.280       0
	    CA     CH2     0.000       1
	     C       C     0.380       2
	     O       O    -0.380       2

	[ bonds ] ; optional 可选
	;atom1    atom2    b0    kb
	     N        H
	     N       CA
	    CA        C
	     C        O
	    -C        N

	[ exclusions ] ; optional 可选
	;atom1    atom2

	[ angles ] ; optional 可选
	;atom1    atom2    atom3    th0    cth

	[ dihedrals ] ; optional 可选
	;atom1    atom2    atom3    atom4    phi0    cp    mult

	[ impropers ] ; optional 可选
	;atom1    atom2    atom3    atom4    q0    cq
	     N       -C       CA        H
	    -C      -CA        N       -O

	[ ZN ]

	[ atoms ]
	   ZN    ZN    2.000    0

文件是自由格式, 唯一的限制是每行最多一个条目. 文件中的第一个域为`[ bondedtypes ]`, 后面跟着四个数字, 分别代表键, 键角, 二面角和异常二面角的相互作用类型. 文件中的残基条目包含原子和(可选的)键, 键角, 二面角, 异常二面角. 电荷组代码代表电荷组的编号, 相同电荷组的原子应该始终按顺序排列. 当使用`pdb2gmx`程序及氢数据库添加缺失的氢原子时(参见5.6.4), `.rtp`条目中定义的原子名称应该精确地对应于氢数据库中使用的名称约定. 键相互作用中的原子名称前可添加减号或加号, 分别代表原子处于残基之前或残基之后. 添加到键, 键角, 二面角和异常二面角的显式参数会覆盖`.itp`文件中的标准参数, 但只能用于特殊情况. 除参数外, 也可为每个键相互作用添加字符串. GROMOS-96的`.rtp`文件就是这样. 这些字符串会被复制到拓扑文件, 通过使用`grompp` C预处理器的`#define`语句, 可用力场参数替换这些字符串.

`pdb2gmx`程序会自动生成所有的键角, 这意味着对大多数力场`[ angles ]`域仅用于覆盖`.itp`参数. 对GROMOS-96力场必须指定所有键角的相互作用编号.

`pdb2gmx`程序会自动为每个旋转键生成一个正常二面角, 倾向位于重原子上. 当使用`[ dihedrals ]`域时, 不会为对应于指定二面角的键生成其他二面角. 可以为一条旋转键指定多个二面角函数. 对CHARMM27力场, 使用`pdb2gmx`程序默认的`-cmap`选项可为二面角增加校正图. 详细信息请参考4.10.4节.

`pdb2gmx`会设置排除数为3, 这意味着最多以3条键连接的原子之间的相互作用都被排除了. 程序会为相隔三条键的所有原子对生成对相互作用(氢原子除外). 当需要排除更多的相互作用, 或不需要生成一些对相互作用时, 可添加`[ exclusions ]`域, 后面跟着位于不同行上的原子名称对, 这些原子之间的所有非键和对相互作用都将被排除.

### 5.6.2 残基构建单元数据库

每个力场对残基都有自己的命名约定. 大部分残基都具有一致的命名, 但有一些残基, 特别是那些具有不同质子化状态的残基, 可能具有许多不同的名称. `.r2b`文件可用于将标准的残基名称转换为力场构建单元名称.

---

<table><caption> 表 5.3 GROMACS内部的残基名称约定</caption>
<tr>
<th style="text-align:center;">简写</th>
<th style="text-align:center;">英文名称</th>
<th style="text-align:center;">含义</th>
</tr>
<tr>
<td style="text-align:center;">ARG</td>
<td style="text-align:center;">protonated arginine</td>
<td style="text-align:center;">质子化精氨酸</td>
</tr>
<tr>
<td style="text-align:center;">ARGN</td>
<td style="text-align:center;">neutral arginine</td>
<td style="text-align:center;">中性精氨酸</td>
</tr>
<tr>
<td style="text-align:center;">ASP</td>
<td style="text-align:center;">negatively charged aspartic acid</td>
<td style="text-align:center;">带负电的天冬氨酸</td>
</tr>
<tr>
<td style="text-align:center;">ASPH</td>
<td style="text-align:center;">neutral aspartic acid</td>
<td style="text-align:center;">中性天冬氨酸</td>
</tr>
<tr>
<td style="text-align:center;">CYS</td>
<td style="text-align:center;">neutral cysteine</td>
<td style="text-align:center;">中性半胱氨酸</td>
</tr>
<tr>
<td style="text-align:center;">CYS2</td>
<td style="text-align:center;">cysteine with sulfur bound to another cysteine or a heme</td>
<td style="text-align:center;">通过硫与另一个半胱氨酸或血红素结合的半胱氨酸</td>
</tr>
<tr>
<td style="text-align:center;">GLU</td>
<td style="text-align:center;">negatively charged glutamic acid</td>
<td style="text-align:center;">带负电的谷氨酸</td>
</tr>
<tr>
<td style="text-align:center;">GLUH</td>
<td style="text-align:center;">neutral glutamic acid</td>
<td style="text-align:center;">中性谷氨酸</td>
</tr>
<tr>
<td style="text-align:center;">HISD</td>
<td style="text-align:center;">neutral histidine with \(\text N_\d\) protonated</td>
<td style="text-align:center;">\(\text N_\d\) 质子化的中性组氨酸</td>
</tr>
<tr>
<td style="text-align:center;">HISE</td>
<td style="text-align:center;">neutral histidine with \(\text N_\e\) protonated</td>
<td style="text-align:center;">\(\text N_\e\) 质子化的中性组氨酸</td>
</tr>
<tr>
<td style="text-align:center;">HISH</td>
<td style="text-align:center;">positive histidine with both  \(\text N_\d\) and \(\text N_\e\) protonated</td>
<td style="text-align:center;">\(\text N_\d\) 和 \(\text N_\e\) 质子化的带正电的组氨酸</td>
</tr>
<tr>
<td style="text-align:center;">HIS1</td>
<td style="text-align:center;">histidine bound to a heme</td>
<td style="text-align:center;">结合到血红素的组氨酸</td>
</tr>
<tr>
<td style="text-align:center;">LYSN</td>
<td style="text-align:center;">neutral lysine</td>
<td style="text-align:center;">中性赖氨酸</td>
</tr>
<tr>
<td style="text-align:center;">LYS</td>
<td style="text-align:center;">protonated lysine</td>
<td style="text-align:center;">质子化赖氨酸</td>
</tr>
<tr>
<td style="text-align:center;">HEME</td>
<td style="text-align:center;">heme</td>
<td style="text-align:center;">血红素</td>
</tr>
</table>

如果力场目录中不存在`.r2b`文件, 或残基未被列出, 会假定构建单元的名称与残基名称相同. `.r2b`文件可包含2或5列. 2列格式为, 第一列为残基名称, 第二列为构建单元名称. 5列格式具有3个附加列, 分别为出现在N端, C端和同时出现在两个末端的残基(单个残基分子)的构建单元. 这对一些力场有用, 例如AMBER力场. 如果不存在一个或多个末端, 应在相应的列中输入短划线.

对残基, 存在GROMACS的命名约定, 此约定仅通过`.r2b`文件和`specbond.dat`文件显现出来(除`pdb2gmx`代码外). 只有当你添加残基类型到`.rtp`文件时, 这个约定是才变得重要. 此约定列在表5.3中. 对于特殊的键, 如与血红素基团相连的键, GROMACS命名约定通过`specbond.dat`引入(参见5.6.7节), 如果需要, 此约定随后可以利用`.r2b`文件进行翻译.

### 5.6.3 原子重命名数据库

力场中使用的原子名称经常不遵​​循IUPAC或PDB约定. `.arn`数据库用于将坐标文件中的原子名称转换为力场中的名称. 未列出的原子会保持原有名称. `.arn`文件有三列, 分别为构建单元名称, 旧的原子名称和新的原子名称. 残基名称支持问号通配符, 用以匹配单个字符.

`share/top`目录下还存在一个通用的原子重命名文件`xlateat.dat`, 可以将坐标文件中常见的非标​​准原子名称转换为IUPAC/PDB约定名称. 因此, 当编写力场文件时, 你可以使用标准的原子名称, 除了将其翻译为力场名称外, 不需要进一步的翻译.

---

### 5.6.4 氢数据库

氢数据库储存在`.hdb`文件中, 它包含了关于`pdb2gmx`程序如何将氢原子连接到已有原子的信息. 在GROMACS 3.3版本以前的数据库中, 根据连接的原子对氢原子进行命名: 把连接原子名称的首字母用'H'代替. 从3.3版本开始, 必须明确列出氢原子, 因为以前的做法仅适用于蛋白质, 因而不能推广用于其它分子. 如果有一个以上的氢原子连接到相同的原子, 氢原子名称的末尾将添加一个数字. 例如, 添加两个氢原子到`ND2`(天冬酰胺), 氢原子将被命名为`HD21`和`HD22`. 这很重要, 因为`.rtp`文件(参见5.6.1节)中的命名必须相同. 氢数据库的格式如下:

	; res    # additions
	         # H add type    H    i    j    k
	ALA      1
	         1       1       H    N    -C   CA
	ARG      4
	         1       2       H    N    CA   C
	         1       1       HE   NE   CD   CZ
	         2       3       HH1  NH1  CZ   NE
	         2       3       HH2  NH2  CZ   NE

第一行为残基名称(ALA或ARG)以及氢原子的类型数, 这些氢原子可根据氢数据库添加到残基中. 后面的行每行对应于一个氢原子的添加:

- 添加的氢原子数
- 添加氢原子的方法, 可能的方法如下:

	1 __单个平面氢原子, 如环或肽键__  
	产生一个氢原子(n), 置于原子(i,j,k)形成的平面内, 位于角(j-i-k)的平分线上, 距离原子i 0.1 nm, 并使角(n-i-j)和(n-i-k)大于90度.

	2 __单个氢原子, 例如羟基__  
	产生一个氢原子(n), 距离原子i 0.1 nm, 并使角(n-i-j)为109.5度, 二面角(n-i-j-k)为反式.

	3 __两个平面氢原子, 如乙烯 -C=CH~2~或酰胺 -C(=O)NH~2~__  
	产生两个氢原子(n1,n2), 距离原子i 0.1 nm, 并使角(n1-i-j)与(n2-i-j)为120度, 二面角(n1-i-j-k)为顺式, (n2-i-j-k)为反式, 这样命名符合IUPAC标准[126].

	4 __两个或三个四面体氢原子, 例如-CH~3~__  
	产生三个(n1,n2,n3)或两个(n1,n2)氢原子, 距离原子i 0.1 nm, 并使角(n1-i-j), (n2-i-j), (n3-i-j)都为109.47度, 二面角(n1-i-j-k)为反式, (n2-i-j-k)为反式+120度, (n3-i-j-k)=反式+240度.

	5 __单个四面体氢原子, 例如C~3~CH__  
	产生一个氢原子(n'), 距离原子i 0.1 nm, 处于四面体构型, 角(n'-i-j), (n'-i-k)和(n'-i-l)都为109.47度.

	6 __两个四面体氢原子, 如C-CH~2~-C__  
	产生两个氢原子(n1,n2), 距离原子i 0.1 nm, 处于四面体构型, 位于平分角j-i-k的平面上, 并且角(n1-i-n2), (n1-i-j)和(n1-ik)都为109.47度.

	7 __两个水中的氢原子__  
	根据SPC[81]水模型的几何构型在原子i周围产生两个氢原子. 对称轴交替位于三个坐标轴两个方向之间.

	10 __三个水中的"氢原子"__  
	根据SPC[81]水模型的几何构型在原子i周围产生两个氢原子. 对称轴交替位于三个坐标轴两个方向之间.
	此外, 在氧原子位置产生一个额外的粒子, 并将其名称的第一个字母以'M'替代. 此方法用于四位点的水模型, 如TIP4P[125].

	11 __四个水中的"氢原子"__  
	同上, 但会在氧原子位置产生两个额外的粒子, 名字分别为'LP1'和'LP2'. 此方法用于五位点的水模型, 如TIP5P[127].

- 新的氢原子的名称(或其前缀, 如`HD2`, 对前面天冬酰胺的例子).
- 三或四个控制原子(i,j,k,l), 其中的第一个始终为与氢原子相连的原子, 另外两个或三个取决于所选的代码. 对于水, 只有一个控制原子.

对一些非常特殊的情况, 可以利用上面的方法近似地解决, 并进行适当的能量最小化, 这样得到的构型用于MD模拟的初始构型已经足够好了. 例如对仲胺氢, 亚硝酰基氢(C=NH)甚至乙炔氢都可利用上面方法2羟基氢进行近似的添加.

### 5.6.5 末端数据库

末端数据库储存在`aminoacids.n.tdb`和`aminoacids.c.tdb`文件中, 分别对应于N端和C端. 文件包含了关于`pdb2gmx`程序如何将原子连接到已有原子, 应该删除或更改哪些原子, 应该添加哪些键相互作用的信息. 文件的格式如下(来源于`gromos43a1.ff/aminoacids.c.tdb`):

	[ None ]

	[ COO- ]
	[ replace ]
	C      C    C    12.011      0.27
	O      O1   OM   15.9994    -0.635
	OXT    O2   OM   15.9994    -0.635
	[ add ]
	2   8   O   C   CA   N
	OM     15.9994  -0.635
	[ bonds ]
	C  O1  gb_5
	C  O2  gb_5
	[ angles ]
	O1  C  O2  ga_37
	CA  C  O1  ga_21
	CA  C  O2  ga_21
	[ dihedrals ]
	N   CA   C   O2   gd_20
	[ impropers ]
	C   CA   O2   O1   gi_1

-----

该文件以块为组织, 每块的标题指定了块的名称. 这些块对应于可添加到分子的不同类型的末端. 在本例中`[ COO- ]`为第一块, 对应于将末端碳原子更改为去质子化的羧基. `[ None ]`为第二末端类型, 对应于维持分子原样的末端. 块名称不能取以下的任何一种: `replace`, `add`, `delete`, `bonds`, `angles`, `dihedrals`, `impropers`. 否则会干扰块的参数, 并可能令读者十分迷惑.

每个块可使用以下选项:

- `[ replace ]`

	将一个已有原子替换为具有不同原子类型, 原子名称, 电荷和/或质量的原子. 此项可用于替换输入坐标文件和`.rtp`数据库中的原子, 但也可用于仅仅重命名输入坐标中的原子, 以使它匹配力场中的名称. 对后一种情况, 也应该存在相应的`[ add ]`段, 用于指示如何添加相同的原子, 这样才能知道序列中的位置和成键. 这种原子可出现在输入坐标中并保持, 或不出现在输入坐标中而是通过`pdb2gmx`程序构建. 对于每一个要替换的原子, 应该输入具有以下域的一行:

	- 要替换原子的名称
	- 新的原子名称(可选)
	- 新的原子类型
	- 新的质量
	- 新的电荷

- `[ add ]`

	添加新的原子. 对于每一个(组)要添加的原子需要两行输入. 第一行包含与氢数据库相同的域(新原子的名称, 原子数目, 添加类型, 控制原子, 参见5.6.4节), 但增加了两个只用于C端的添加类型

	8 __双羧基氧原子, -COO^-^__  
	根据规则3产生两个氧原子(n1,n2), 距离原子i 0.136 nm, 角(n1-i-j)和(n2-i-j)为117度

	9 __羧基氧原子和氢原子, -COOH__  
	根据规则3产生两个氧原子(n1,n2), n1和n2分别距离原子i 0.123 nm和0.125 nm, 角(n1-i-j)为121度, (n2-i-j)为115度. 根据规则2在n2周围产生一个氢原子(n'), 其中n'-n2-i和n'-n2-i-j应分别对应于n-i-j和n-i-j-k.

	此行之后, 下面的一行指定了添加原子的细节, 与替换原子的方式相同, 即:
	
	- 原子类型
	- 质量
	- 电荷
	- 电荷组(可选)

	如氢数据库(参见5.6.1节)一样, 当一个以上的原子连接到一个已有原子时, 原子名称的末尾会追加一个数字. __注意__, 像在氢数据库中一样, 原子名称现在与控制原子处于同一行, 而在GROMACS 3.3版本之前它位于第二行的开始. 当电荷组域空白时, 添加的原子和它连接的原子将具有相同的电荷组编号.

- `[ delete ]`

	删除已有的原子. 每个原子名称一行.

- `[ bonds ]`, `[ angles ]`, `[ dihedrals ]`和`[ impropers ]`

	添加额外的键参数. 格式与`*.rtp`文件中使用的相同, 参见5.6.1节.

### 5.6.6 虚拟位点数据库

由于不能依赖输入文件中氢的位置, 我们需要一个特殊的输入文件以确定要添加的虚拟氢位点的几何构型和参数. 为创建更复杂的虚拟位点(例如当保持整个芳香侧链刚性时), 我们还需要关于平衡键长和侧链中所有原子角度的信息. 对每个力场, 这些信息在`.vsd`文件中指定. 与末端类似, 对`.rtp`文件中每个残基类型都有一个这样的文件.

虚拟位点数据库真的不是一个非常简单的信息列表. 它开始的两段指定了用于CH~3~, NH~3~和NH~2~基团的质量中心(通常称为MCH~3~/MNH~3~). 根据氢原子和重原子之间的平衡键长和键角, 我们需要在这些质量中心之间施加略有不同的约束距离. __注意__, 我们 __不__ 需要指定实际的参数(会自动生成), 而只需要指定使用的质量中心类型. 为此, 有三个段名称`[ CH3 ]`, `[ NH3 ]`和`[ NH2 ]`. 对每个段我们需要三列. 第一列为连接到2/3氢原子的原子类型, 第二列为连接的下一个重原子的类型, 第三列为使用的质量中心类型. 作为一种特殊情况, 在`[ NH2 ]`段的第二列也可以指定为`planar`, 代表将使用不同的构造方法, 而不使用质量中心. 对于NH~2~基团是否应为平面, 目前的一些力场观点不一, 但我们力图保持力场默认的平衡参数.

虚拟位点数据库的第二部分明确地包含芳香族侧链的原子对/三联组的平衡键长和键角. 目前, 虚拟位点生成代码的特定例程会读入这些项, 因此如果你想扩展它, 如扩展到核酸, 你需要编写新的代码. 这些段根据氨基酸的短名称进行命名(`[ PHE ]`, `[ TYR ]`, `[ TRP ]`, `[ HID ]`, `[ HIE ]`, `[ HIP ]`), 简单地包含2或3列原子名称, 接着是指定键长(以nm为单位)或键角(以度为单位)的数字. __注意__, 对整个分子的平衡几何构型有所近似, 如果分子未处于自然状态, 其单个键长/键角的值可能与平衡值不同.

### 5.6.7 特殊键

`pdb2gmx`程序生成残基间化学键时使用的主要机制为, 从头到尾连接不同残基中的骨架原子进而形成大分子. 在某些情况下(如二硫键, 血红素基团, 支化聚合物), 有必要创建非骨架残基间的化学键. `specbond.dat`文件即用于此功能. 残基必须属于相同的`[ moleculetype ]`. 当操纵不同链之间的特殊残基间的化学键时, `pdb2gmx`程序的`-merge`和`-chainsep`功能很有用.

`specbond.dat`文件的第一行表示文件中的条目数. 如果你添加了一个新的条目, 请确保增加此数字. 文件的其余行提供创建键的具体说明. 行的格式如下:

`resA atomA nbondsA resB atomB nbondsB length newresA newresB`

分别代表:

1. `resA` 参与成键的残基A的名称.
2. `atomA` 残基A中形成键的原子的名称.
3. `nbondsA` `atomA`可以形成的键的总数.
4. `resB` 参与成键的残基B的名称.
5. `atomB` 残基B中形成键的原子的名称.
6. `nbondsB` `atomB`可以形成的键的总数.
7. `length` 键的参考长度. 在提供给`pdb2gmx`程序的坐标文件中, 若`atomA`和`atomB`之间的距离不在`length`±10%范围内, 它们之间不会形成键.
8. `newresA` 残基A的新名称, 如果必要. 有些力场对与二硫键或血红素相连的半胱氨酸使用了CYS2之类的名称.
9. `newresb` 残基B的新名称, 同上.
