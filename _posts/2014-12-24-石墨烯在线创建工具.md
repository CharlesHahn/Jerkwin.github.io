---
 layout: post
 title: 石墨烯在线创建工具
 categories:
 - 科
 tags:
 - 编程
 - js
---

## 2014-12-24 10:03:13

前几天的一篇[博文](http://jerkwin.github.io/2014/12/15/八面体与截角八面体团簇在线创建工具/)中分享了一个在线的八面体创建工具, 很多人看了之后觉得很有用.
我今天再分享一个自己的小工具, 可用于创建简单的石墨烯构型.
方法的原理请参考以前的一篇[博文](http://jerkwin.github.io/2014/05/09/石墨烯-建模-几何性质及力场模拟/).



--------

尺度(基本单元)：
长 <input type="box" id="wid" value="10" /> &nbsp;&nbsp;&nbsp;&nbsp;
宽 <input type="box" id="hig" value="0" />(设为0时会根据长度自动计算, 生成尽可能正方构型) <br/>

C-C键长(&#197;)：<input type="box" id="rcc" value="1.4" /> <br/>

平面内位置随机(&#197;)：
X方向 <input type="box" id="ranX" value="0" /> &nbsp;&nbsp;&nbsp;&nbsp;
Y方向 <input type="box" id="ranY" value="0" /> <br/>
Z方向(竖直)涨落(&#197;)：
振幅 <input type="box" id="ranZ" value="0" /> &nbsp;&nbsp;&nbsp;&nbsp; 
X方向周期数 <input type="box" id="cycX" value="1" /> &nbsp;&nbsp;&nbsp;&nbsp; 
Y方向周期数 <input type="box" id="cycY" value="1" /> <br/>

<input type="button" value="创建" onClick="genCoor()" style="width:100px; height:30px" /> <br/>

<table><tr>
<td>
	XYZ文件<br/><textarea id="xyzCoor" style="width:400px; height:500px; resize: none"></textarea></td>
<td>
	<figure><figurecaption>结构</figurecaption><br/>
	<script>
		var Mol=new ChemDoodle.TransformCanvas3D('Mol-1', 400,500);
		Mol.specs.backgroundColor='black';
		Mol.specs.set3DRepresentation('Ball and Stick');
		Mol.specs.projectionPerspective_3D = false;
		Mol.loadMolecule(ChemDoodle.readXYZ("", 1));
	</script></td>
</tr></table>

<script>
var $=function(id){return document.getElementById(id)};

function genCoor() {
	var i, j, k, X0, Y0, Z0,
		M=parseInt($("wid").value), N=parseInt($("hig").value),
		a=parseFloat($("rcc").value), Zran=parseFloat($("ranZ").value),
		Xran=parseFloat($("ranX").value), Yran=parseFloat($("ranY").value), 
		Xcyc=parseFloat($("cycX").value), Ycyc=parseFloat($("cycY").value)

	if(N===0) N=parseInt(Math.sqrt(3)*M/3.)
	if(Xcyc>0.) Xcyc = 2.*Math.PI*Xcyc
	if(Ycyc>0.) Ycyc = 2.*Math.PI*Ycyc

	var t=Math.sqrt(3)/4., X=[], Y=[]

	X[1]=0+t;               Y[1]=1/2.;
	X[4]=0+t;               Y[4]=5/2.;
	X[2]=Math.sqrt(3)/2.+t; Y[2]=1.;
	X[3]=Math.sqrt(3)/2.+t; Y[3]=2.;

	for(k=1; k<=4; k++) { X[k] *=a; Y[k] *= a }

	var Wid=Math.sqrt(3)*a, Hig=3.*a

	var Fmol=4*M*N+"\n" + "Graphene:"+ M+"x"+N+" Rcc="+a+" Box:"+fmtNum(M*Wid,12.6) + fmtNum(N*Hig,12.6) + "\n"
	for(i=1; i<=M; i++) {
		X0=(i-1)*Wid
		for(j=1; j<=N; j++) {
			Y0=(j-1)*Hig; Z0=0
			if(Xran) X0 += Math.random()*Xran
			if(Yran) Y0 += Math.random()*Yran
			if(Zran) {
				Z0 = Zran
				if(Xcyc>0.) Z0 *= Math.sin(Xcyc*i/M)
				if(Ycyc>0.) Z0 *= Math.sin(Ycyc*j/N)
			}
			for(k=1; k<=4; k++) Fmol += "C " + fmtNum(X[k]+X0,12.6) + fmtNum(Y[k]+Y0,12.6) + fmtNum(Z0, 12.6) + "\n"
		}
	}
	
	$("xyzCoor").value=Fmol
	Mol.loadMolecule(ChemDoodle.readXYZ(Fmol, 1));
}

function fmtNum(num, fmt) {
	var fmt=String(fmt), m=fmt.split(".")[0]
	num=num.toFixed(fmt.split(".")[1])
	if(num.length<m) num=Array(m-num.length+1).join(" ")+num
	return num
}

</script>

