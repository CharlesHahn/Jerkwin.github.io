---
 layout: post
 title: GROMACS中文手册第7章：运行参数和程序 7.3.1-7.3.15 
 categories:
 - 科
 tags:
 - GMX
---

# 第七章　运行参数和程序

## 7.3 运行参数

### 7.3.1 通用参数

参数的默认值在括号中给出. 列表中的第一个选项始终是默认选项. 单位在方括号中给出, 破折号和下划线没有区别. 有一份示例的`.mdp`文件, 可用于开始一个正常的模拟. 你也可以编辑它以满足特定需求.

### 7.3.2 预处理

`include`:  
在你的拓扑信息中包含特定的目录.  
格式:  `-I/home/john/mylib -I../otherlib`

`define`:  
传递给预处理器的定义, 默认不存在定义. 你可以在自己定制的拓扑文件中使用任何定义来控制选项. 有以下默认可用的选项:

 `-DFLEXIBLE`  
	告诉`grompp`在拓扑信息中使用柔性的水模型而不是刚性的水模型, 对简正模式分析有用.

 `-DPOSRES`  
	告诉`grompp`在拓扑信息中包括`posre.itp`, 用于位置限制.

### 7.3.3 运行控制

`integerator`: (尽管名字的意思是积分方法, 但此参数包括了实际上不属于积分的算法. `steep`及其下的所有条目都属于此类)

+ `md`  
	蛙跳式算法积分牛顿运动方程.

+ `md-vv`  
	速度Verlet算法积分牛顿运动方程. 对从同样轨迹的对应点开始的恒NVE模拟, 此选项将产生与`md`选项解析等同的轨迹, 但不是二进制完全等同. 由于动能是从整个积分步的速度计算所得, 因此会稍微过高. 这种积分方法的优点是更精确, 使用了基于Trotter展开的可逆的Nose-Hoover和Parrinello-Rahman耦合积分, 以及(略过小)整步的速度输出. 这些优点的代价是额外的计算量, 特别是当使用约束和并行的额外通讯时. 注意, 对几乎所有的模拟`md`积分方法都足够精确.

+ `md-vv-avek`  
等同于`md-vv`的速度Verlet算法, 除了动能是由`md`积分方法的两半步动能的平均值决定以外, 因而此方法更精确. 当与Nose-Hoover和/或Parrinello-Rahman耦合联用时, 此选项会略微增加计算成本.

+ `sd`  
准确, 高效的蛙跳式随机动力学积分方法. 使用约束时, 在每积分步, 坐标需要被约束两次. 取决于力的计算成本, 这可能会占用模拟的大部分时间. 一组或多组原子(`tc-grps`)的温度可通过`ref-t`[K]设定, 每组的逆摩擦常数通过`tau-t`[ps]设定. 参数`tcoupl`被忽略. 随机数发生器使用`ld-seed`初始化. 当作为恒温器使用时, 2 ps是`tau-t`的一个适当值, 因为这时的摩擦比水的内摩擦低, 同时摩擦也高到足以除去多余的热量. __注意__: 温度偏差的衰减是使用具有相同`tau-t`的Berendsen恒温器的两倍.

+ `sd2`  
曾经是默认的SD积分方法, 但现在已过时. 每个坐标每一步需要四个高斯随机数. 使用约束时, 温度会稍微过高.

+ `bd`  
Brown或位置Langevin动力学的欧拉积分方法, 速度为力与摩擦系数(`bd-fric`[amu ps^-1^])的比值, 再加上随机热噪声(`ref-t`). 当`bd-fric=0`时, 每个粒子的摩擦系数由mass/`tau-t`计算, 与`sd`积分方法类似. 随机发生器利用`ld-seed`初始化.

+ `steep`  
能量最小化的最陡下降算法. 最大步长为`emstep`[nm], 容差为`emtol`[kJ mol^-1^ nm^-1^].

+ `cg`  
能量最小化的共轭梯度算法, 容差为`emtol`[kJ mol^-1^ nm^-1^]. 当由`nstcgsteep`决定的最速下降步骤完成后, 使用CG会更高效. 简正模式分析前进行的最小化需要非常高的精度, 为此, 编译GROMACS时应使用双精度.

+ `l-bfgs`  
能量最小化的准牛顿算法, 基于低内存需求的Broyden-Fletcher-Goldfarb-Shanno方法, 在实用中, 似乎比共轭梯度法收敛更快, 但是由于必须的校正步骤, 此方法(暂且)不能并行.

+ `nm`  
对`tpr`文件中的结构进行简正模式分析. 应该使用双精度编译的GROMACS.

+ `tpi`  
测试粒子插入. 拓扑结构中的最后一个分子是测试粒子. 需要`mdrun`的`-rerun`选项并提供一条轨迹. 这条轨迹不能包含待插入的分子. 每帧中会进行`nsteps`次插入操作, 插入时分子的位置和取向都是随机的. 当`nstlist`大于1时, 围绕相同随机位置半径为`rtpi`的球体进行`nstlist`次插入, 并使用相同的邻区列表(和相同的长程能量, 若`rvdw>rlist`或`rcoulomb>rlist`, 只适用于单原子分子). 因为构造邻区列表很昂贵, 你可以使用同一个列表几乎免费地进行若干次额外的插入. 随机种子由`ld-seed`设定. 玻尔兹曼加权的温度由`ref-t`设定, 它应与原始轨迹的模拟温度匹配. tpi正确地考虑了色散校正. 所有相关的量都会写入到由`mdrun`的`-tpi`选项指定的文件中. 插入能量的分布会写入到由`mdrun`的`-tpid`选项指定的文件中. 不产生轨迹或能量文件. 并行tpi与单节点tpi的结果完全相同. 对于带电分子, 使用密格点的PME最准确, 也很有效, 因为对每一帧系统的势能只需要计算一次.

+ `tpic`  
测试粒子插入到一个预定义的空腔位置. 步骤与tpi相同, 除了需要从轨迹中读入一个额外的坐标, 作为插入位置. 要被插入分子的中心应位于0,0,0. GROMACS不会为你完成这点, 因为针对不同的情况, 采用不同的方式定心可能更好. 同时, `rtpi`设置围绕此处球体的半径. 对每一帧只进行一次邻区搜索, 不会使用`nstlist`. 并行tpic与单节点tpic的结果完全相同.

`tinit`: (0) [ps]  
运行的起始时间(只对`md`, `sd`和`bd`积分方法有意义)

`dt`: (0.001) [ps]  
积分时间步长(只对`md`, `sd`和`bd`积分器有意义)

`nsteps`: (0)  
积分或最小化的最大步数, -1意味着不限制步数

`init-step`(0)  
起始步. 第i步的运行时间的计算公式为: t = `tinit` + `dt` * (`init-step` + i). 自由能计算中lambda的计算公式为: lambda=`init-lambda` + `delta-lambda` * (`init-step`+i). 非平衡态MD的参数也依赖于步数. 因此, 为了准确的重新启动或重做部分模拟, 可能需要将`init-step`设置为重启帧的步数. `gmx convert-tpr`可自动执行此操作.

`comm-mode`

+ `Linear`  
去除质心的平动

+ `Angular`  
去除去质心的平动以及围绕质心的转动

+ `None`  
不限制质心的运动

`nstcomm`: (100) [步]  
去除质心运行的频率

`comm-grps`:  
需要去除质心运动的组, 默认是整个体系

### 7.3.4 Langevin动力学

`bd-fric`: (0) [amu ps^-1^]  
Brown动力学摩擦系数. 当`bd-fric=0`时, 每个粒子的摩擦系数为其质量与`tau-t`的比值.

`ld-seed`: (-1) [整数]  
用于初始化随机和Brown动力学的热噪声随机数发生器. 当`ld-seed`设置为-1时, 将使用伪随机种子. 当在多个处理器上运行BD或SD时, 每个处理器使用的种子等于`ld-seed`加上处理器的编号.

### 7.3.5 能量最小化

`emtol`: (10.0) [kJ mol^-1^ nm^-1^]  
当最大的力比这个值小时就认为最小化收敛

`emstep`: (0.01) [nm]  
初始步长大小

`nstcgsteep`: (1000) [步]  
用共轭梯度进行能量最小化时执行一步最速下降的频率

`nbfgscorr`: (10)  
L-BFGS最小化的校正步数. 数值越高(至少理论上)越准确, 但速度更慢.

### 7.3.6 壳层分子动力学

当体系中存在壳层或柔性约束时, 会在每个时间步对壳层的的位置和柔性约束的长度进行优化, 直到在壳层和约束上的力的RMS值小于`emtol`, 或达到迭代的最大次数(`niter`)

`emtol`: (10.0) [kJ mol^-1^ nm^-1^]  
当最大的力比这个值小时就认为最小化收敛. 对壳层MD这个值最大是1.0, 但由于此变量也用于能量最小化, 所以其默认值为10.0.

`niter`: (20)  
优化壳层位置和柔性约束的最大迭代次数.

`fcstep`: (0) [ps^2]  
优化柔性约束的步长. 应设置为mu/(d^2^V/dq^2^), 其中mu为柔性约束中两粒子的约化质量, d^2^V/dq^2^是势能在约束方向上的二阶导数. 这个数字对不同的柔性约束不要相差太大, 因为迭代次数进而运行时间对`fcstep`非常敏感. 多尝试几个值!

### 7.3.7 测试粒子插入

`rtpi`: (0.05) [nm]  
测试粒子插入半径, 请参考积分方法`tpi`和`tpic`

### 7.3.8 输出控制

`nstxout`: (0) [步]  
将坐标写入输出轨迹文件的间隔步数, 最后一步的坐标始终会写入

`nstvout`: (0) [步]  
将速度写入输出轨迹文件的间隔步数, 最后一步的速度始终会写入

`nstfout`: (0) [步]  
将力写入输出轨迹文件的间隔步数

`nstlog`: (1000) [步]  
将能量写入log文件的间隔步数, 最后一步的能量始终会写入

`nstcalcenergy`: (100)  
两次能量计算之间的间隔步数, 0表示从不计算. 此选项仅与动力学有关. 使用双程截断时`nstcalcenergy`应等于`nstlist`或其倍数. 此选项会影响并行模拟的性能, 因为计算能量需要所有进程之间的全局通讯, 在高度并行的情况下, 这可能会成为计算瓶颈.

`nstenergy`: (1000) [步]  
将能量写入能量文件的间隔步数, 最后一步的能量始终会写入, 应是`nstcalcenergy`的倍数. 注意, 对所有MD步数与`nstcalcenergy`的模, 精确的能量总和及其涨落都存储在能量文件中, 所以当`nstenergy>1`时, `g_energy`仍可以给出精确的能量平均值及其涨落

`nstxout-compressed`: (0) [步]  
利用有损压缩输出位置坐标的间隔步数

`compressed-x-precision`: (1000) [实数]  
压缩轨迹文件的精度

`compressed-x-grps`:  
写入到压缩轨迹文件的组, 默认写入整个体系(如果`nstxout-compressed`>0)

`energygrps`:  
写入能量文件的组

### 7.3.9 邻区搜索

`cutoff-scheme`:

+ `Verlet`  
利用缓冲生成粒子的配对列表. 缓冲区的大小会根据`verlet-buffer-tolerance`自动进行设置, 除非将其设置为-1, 在这种情况下会使用`rlist`. 此选项在`rvdw=rcoulomb`处存在一个明显, 准确的截断. 目前仅支持截断, 反应场, PME静电和普通LJ. `Verlet`方案不支持`mdrun`的一些功能, 但`grompp`会对此进行检查. 只有`Verlet`支持原生GPU加速. 使用GPU加速的PME或单独的PME队列时, `mdrun`会通过缩放`rcoulomb`和格点间距自动调整CPU/GPU负载平衡. 可以使用`-notunepme`关闭此功能. 当体系中不含水分子, 或`group`使用配对列表缓冲维持能量守恒时, `Verlet`会比`group`快.

+ `group`  
为原子组生成配对列表. 这些组对应于拓扑信息中的电荷组. 这是4.6版本之前唯一的截断处理方案. 配对列表没有显式的缓冲. 这使得计算水的力时效率很高, 但只有显式地加入缓冲时, 能量才守恒.

`nstlist`: (10) [步]

+ `>0`  
更新邻区列表(以及远程力, 当使用双程截断时)的频率. 当该值为0时, 邻区列表只生成一次. 对能量最小化, 当`nstlist>0`时, 每次计算能量都将更新邻区列表. 设置了`cutoff-scheme=Verlet`和`verlet-buffer-tolerance`, `nstlist`实际是最小值且`mdrun`可能会增大它的值, 除非将其设置为1. 对GPU上的并行模拟和(或)非键合力计算, 取20或40往往能得到最佳性能.  
使用`cutoff-scheme=Group`和非准确的截断, `nstlist`会影响模拟的精确性, 不能随意选择.

+ `0`  
邻区列表仅构建一次, 且不再更新. 这主要用于真空中模拟, 这种情况下所有粒子彼此间都能看到对方.

+ `-1`  
自动更新频率, 仅支持`cutoff-scheme=group`. 此选项只能用于切换, 移位或用户定制的势能函数, 其截断可以小于`rlist`. 缓冲的大小为`rlist`减去最长的截断值. 以根据前一步的邻区搜索确定的电荷组几何中心开始, 只有当一个或多个粒子移动的距离超过缓冲大小的一半时, 邻区列表才会更新. 更新时会考虑因压力耦合或`deform`选项引起的坐标缩放. 此选项可确保没有截断虚假, 但对于较大的体系, 计算成本可能会很高, 因为邻区列表的更新频率仅由一或两个粒子决定, 它们移动的距离稍微超出缓冲长度的一半(这并不一定意味着邻区列表是无效的), 而99.99%的粒子都不需要更新.

`nstcalclr`: (-1) [步]  
使用组截断方案时, 控制远程力的计算周期.

+ `1`  
在每一步都计算长程力. 当静电和范德华相互作用使用单独的带缓冲的邻区列表时, 此选项有用, 特别地, 它支持范德华的截断距离大于静电的(例如与PME联用时有用). 然而, 对这两种相互作用使用相同的长程截断值, 并在每一步更新它们是没有意义的--此时将一切都放在短程列表中会稍快一些.

+ `> 1`  
每`nstcalclr`步计算一次长程力, 并使用多时间步积分方法将它们组合起来. 现在可以使用超过`nstlist`的频率进行计算, 因为会保存列表. 这可能是一个好主意, 例如, 对于变化比静电慢的范德华相互作用.

+ `-1`  
当进行邻区搜索时计算长程力. 虽然这是默认值, 你可能要考虑更频繁地更新长程力.  
注意, PP-PME负载均衡可能会自动导致双程力(twin-range force)的计算, 这是为了维持所选择的范德华相互作用半径, 即便负载均衡正在改变静电截断. 如果`.mdp`文件已经指定了双程相互作用(比如每2-3步使用比PME静电更长的截断计算Lennard-Jones相互作用), 负载均衡对Lennard-Jones也会有小的影响, 因为短程截断(在其内部每步都计算力)改变了.

`ns-type`:

+ `grid`  
在盒子中生成格点, 且在每`nstlist`步构建新的邻区列表时才检查在相邻格点区域内的原子. 对大的体系, 格点搜索比简单搜索快得多.

+ `simple`  
每`nstlist`步构建新的邻区列表时, 检查盒子中的每个原子(仅与`cutoff-scheme=group`联用).

`pbc`:

+ `xyz`  
在所有方向上使用周期性边界条件.

+ `no`  
不使用周期性边界条件, 忽略盒子. 不使用截断的模拟, 可将所有的截断设为0, 并且`nstlist=0`. 对单个MPI队列, 不使用截断时, 使用`nstlist=0`, `ns-type=simple`可获得最佳性能.

+ `xy`  
只在x和y方向上使用周期性边界条件. 仅适用于`ns-type=grid`, 可与`walls`联用. 没有墙或只有一个墙时, 体系在z方向上大小是无限的, 因此不能使用压力耦合或Ewald加和方法. 当使用两面墙时没有这些缺点.

`periodic-molecules`:

+ `no`  
分子是有限的, 可以使用快速的分子PBC

+ `yes`  
用于含有通过周期性边界条件与自身耦合的分子的体系, 需要较慢的PBC算法, 分子在输出中不保持完整

`verlet-buffer-tolerance`: (0.005) [kJ/mol/ps]  
只对`cutoff-scheme=Verlet`有用. 此选项设置由Verlet缓冲引起的每个粒子配对相互作用的最大允许误差, 间接设置了`rlist`. 若`nstlist`和Verlet缓冲大小都固定(出于性能原因), 不在配对列表中的粒子对在`nstlist`-1步内能够不时地进入截断距离内. 这将导致非常小的能量跳跃. 对等温系综, 对于给定的截断和`rlist`可估算出这些非常小的能量跳跃. 估算时假定均相的粒子分布, 因此对多相体系可能会略微低估误差. 对于较长的配对列表寿命(`nstlist`-1)*dt, 缓冲会被高估, 因为忽略了粒子之间的相互作用.  
由于误差抵消, 总能量的实际漂移幅度通常小一到两个数量级. 注意, 与基于简单粒子配对的列表相比, GROMACS的配对列表设置导致漂移降低为原来的1/10, 生成的缓冲大小考虑了这一点影响. 不使用动力学(能量最小化等)时, 缓冲为截断的5%. 对NVE模拟, 会使用初始温度, 除非初始温度为零, 此时使用10%的缓冲. 对NVE模拟通常需要降低容差以便在纳秒的时间尺度达到适当能量守恒. 要覆盖自动缓冲设置, 可使用`verlet-buffer-tolerance=-1`, 并手动设置`rlist`.

`rlist`: (1) [nm]  
短程邻区列表的截断距离. 使用`cutoff-scheme=Verlet`时, 默认由`verlet-buffer-tolerance`选项设置, 并忽略`rlist`值.

`rlistlong`: (-1) [nm]  
长程邻区列表的截断距离. 此参数仅适用于切换势的双程截断设置. 在这种情况下, 需要一个缓冲区域以考虑电荷组的大小. 在所有其他情况下, 该参数自动设置为最长的截断距离.

### 7.3.10 静电

`coulombtype`:

 `Cut-off`  
双程截断, 其中邻区截断距离为`rlist`, 库仑截断距离为`rcoulomb`,  且`rcoulomb≥rlist`.

 `Ewald`  
经典Ewald加和方法. 实空间的截断距离`rcoulomb`应等于`rlist`. 例如, 使用`rlist=0.9, rcoulomb=0.9`. 倒易空间使用的波矢的最大振幅由`fourierspacing`控制. 直接/倒易空间的相对精度由`ewald-rtol`控制.  
注: Ewald算法的复杂度为O(N^3/2^), 因此对于大的体系非常慢. 包含这个方法主要是为了作为参考--在大多数情况下PME方法的性能都好得多.

 `PME`  
快速平滑粒子网格Ewald(SPME)静电方法. 直接空间类似于Ewald加和方法, 而倒易空间部分使用FFT进行计算. 格点尺寸由`fourierspacing`控制, 内插的阶数由`pme-order`控制. 使用0.1 nm格点间距的三次内插方法时, 静电力的计算精度为2-3*10^-4^. 由于VDW截断导致的误差大于此, 你可以尝试使用0.15 nm的格点间距. 当并行运行时, 内插的并行性能优于FFT, 因此可以试着减小格点尺寸, 同时增加内插.

 `P3M-AD`  
粒子粒子粒子网格算法, 具有长程静电相互作用的解析梯度. 除影响函数对格点进行了优化外, 方法和代码与SPME完全相同, 优化使在计算精度略有提高.

 `Reaction-Field electrostatics`  
库仑截断距离为`rcoulomb`的反应场, 其中`rcoulomb≥rlist`. 超过截断距离的介电常数为`epsilon-rf`. 当`epsilon-rf=0`时, 介电常数无穷大.

 `Generalized-Reaction-Field`  
库仑截断距离为`rcoulomb`的广义反应场, 其中`rcoulomb≥rlist`. 超过截断距离的介电常数为`epsilon-rf`. 离子强度由带电的(即非零电荷)电荷组计算. GRF势的温度通过`ref-t` [K]设定.

 `Reaction-Field-zero`  
在GROMACS中, 使用`cutoff-scheme=group`时, 正常的反应场静电方法会导致能量守恒性很差. `Reaction-Field-zero`通过将超出截断距离的势能设为零解决了这个问题. 这种方法只适用于介电常数无穷大(`epsilon-rf=0`)的情况, 因为只有这样力在截断距离处才能消失. `rlist`应比`rcoulomb`大0.1至0.3 nm, 以考虑电荷组的大小已及更新邻区对时扩散的影响. 这一点以及使用查表代替解析函数使得`Reaction-Field-zero`的计算比正常反应场更耗时.

 `Reaction-Field-nec`  
与`Reaction-Field`相同, 但是GROMACS 3.3以前版本中的实现. 没有使用反应场校正排除原子对和自身对的影响. 使用反应场计算1-4相互作用. 因排除不具有1-4相互作用的粒子对而缺少的校正达到总静电能的百分之几, 并导致力和压力有微小的差别.

 `Shift`  
类似于`vdwtype`的`Shift`. 你可能想使用`Reaction-Field-zero`代替, 它具有类似的势能形状, 但具有物理意义, 并且含有排除校正项, 计算的能量更好.

 `Encad-Shift`  
库仑势在整个范围内降低, 使用Encad模拟包中的定义

 `Switch`  
类似于`vdwtype`的`Switch`. 切换库仑势可导致严重的假象, 建议: 使用`Reaction-Field-zero`代替.

 `User`  
`mdrun`需要使用文件`table.xvg`, 里面包含用户定义的势能函数, 包括排斥, 色散和库仑相互作用. 当存在对相互作用时, `mdrun`也需要描述对相互作用的文件`tablep.xvg`. 当非键和对相互作用需要使用相同的相互作用时, 用户可以为两个表格文件指定相同的文件名. 这些文件应包含7列:  `x`值, `f(x)`, `-f'(x)`, `g(x)`, `-g'(x)`, `h(x)`, `-h'(x)`, 其中`f(x)`为库仑函数, `g(x)`为色散函数, `h(x)`为排斥函数. 当`vdwtype`不为`User`时, 会忽略`g`, `-g'`, `h`和`-h'`. 对非键相互作用, `x`的取值应该从0到最大截断距离+`table-extension`, 彼此的间距应均匀. 对于对相互作用会使用文件中的表格长度. 当使用混合精度时, 非用户自定义表格的最佳间距为`0.002` [nm], 使用双精度时, 最佳值为`0.0005` [nm]. 在`x=0`处的函数值并不重要. 更多信息请参考印刷手册.

 `PME-Switch`  
PME和对直接空间部分切换函数的组合(参见上文). `rcoulomb`可以小于`rlist`.  
主要用于等能量模拟(注意, `PME`与`cutoff-scheme=Verlet`联用会更有效).

 `PME-User`  
PME和用户表格的组合(参见上文). `rcoulomb`可以小于`rlist`. `mdrun`会从用户表格中减去PME网格的贡献. 因为这个扣除, 用户表格应包含大约10个十进制的位置.

 `PME-User-Switch`  
PME-User和切换函数的组合(参见上文). 对最终粒子之间的相互作用使用切换函数, 即, 同时对用户提供的函数和PME网格校正部分使用切换函数.

`coulomb-modifier`

+ `Potential-shift-Verlet`  
选择`Potential-shift`与Verlet截断方案, 因为它(几乎)不增加计算量; 选择`None`与组截断方案.

+ `Potential-shift`  
对库仑势进行固定的移位以使其在截断处为零. 这使得势能可由力的积分得到. 注意这并不影响力或采样.

+ `None`  
使用未经修改的库仑势. 与组方案连用时, 这意味着没有使用准确的截断, 会计算邻区列表中的所有粒子对之间的能量和力.

`rcoulomb-switch`: (0) [nm]  
从何处开始切换库仑势, 只适用于应用力或势能的切换时.

`rcoulomb`: (1) [nm]  
库伦截断距离

`epsilon-r`: (1)  
相对介电常数. 为0时意味着无穷大.

`epsilon-rf`: (0)  
反应场的相对介电常数, 仅与反应场静电方法一起使用. 为0时意味着无穷大.

### 7.3.11 VdW

`vdwtype`:

+ `Cut-off`  
双程截断, 邻区列表的截断距离为`rlist`, VdW截断距离为`rvdw`, 其中 `rvdw≥rlist`.

+ `PME`  
使用快速平滑粒子网格Ewald(SPME)方法计算VdW相互作用. 与静电计算类似, 格点大小由`fourierspacing`控制. 内插的阶数由`pme-order`控制. 直接/倒易空间的相对精度由`ewald-rtol-lj`控制, 倒易程序部分使用的特定组合规则由`lj-pme-comb-rule`设置.

+ `Shift`  
此功能已废弃, 并被`vdw-modifier = Force-switch`取代. LJ(不包括Buckingham)势在整个范围内降低, 相应的力在`rvdw-switch`和`rvdw`之间平滑地衰减到零. 邻区搜索的截断距离`rlist`应该比`rvdw`大0.1至0.3 nm以考虑电荷组大小及邻区列表更新时扩散的影响.

+ `Switch`  
此功能已废弃, 并被`vdw-modifier = Potential-switch`取代. LJ(不包括Buckingham)势在`rvdw-switch`之内是正常的, 之后被逐渐降低, 并在`rvdw`处达到零. 势能和力函数都是连续平滑的. 但需要注意, 所有的切换函数都会导致力的突起(增加, 因为我们切换了势能). 邻区搜索的截断距离`rlist`应该比`rvdw`大0.1至0.3 nm以考虑电荷组大小及邻区列表更新时扩散的影响.

+ `Encad-Shift`  
LJ(不包括Buckingham)势在整个范围内降低, 使用Encad模拟包中的定义.

+ `User`  
参看`coulombtype`的`user`选项. `x=0`处的函数值并不重要. 如果你想使用LJ校正, 请确保`rvdw`对应于用户定义函数的截断距离. 若`coulombtype`没有设置为`User`, 会忽略`f`和`-f'`.

`vdw-modifier`:

+ `Potential-shift-Verlet`  
选择`Potential-shift`与Verlet截断方案, 因为它(几乎)不增加计算量; 选择`None`与组截断方案.

+ `Potential-shift`  
对VdW势进行固定的移位以使其在截断处为零. 这使得势能可由力的积分得到. 注意这并不影响力或采样.

+ `None`  
使用未经修改的VdW势. 与组方案连用时, 这意味着没有使用准确的截断, 会计算邻区列表中的所有粒子对之间的能量和力.

+ `Force-switch`  
在`rvdw-switch`和`rvdw`之间平滑地将力切换至零. 这使得势能在整个范围内移位并在截断处切换至零, 注意, 这种计算方法比普通截断方法更耗时, 并且不要求能量守恒, 因为`Potential-shift`的能量守恒性也差不多.

+ `Potential-switch`  
在`rvdw-switch`和`rvdw`之间平滑地将势能切换至零. 注意, 这会导致力的数值在切换区域产生很大的假象, 并且计算也更耗时. 只有当你使用的力场要求使用时, 才能使用此选项.

`rvdw-switch`: (0) [nm]  
从何处开始切换LJ力或势能, 只适用于应用力或势能的切换时.

`rvdw`: (1) [nm]  
LJ或Buckingham的截断距离.

`DispCorr`:

 `no`  
不使用任何修正

 `EnerPres`  
对能量和压力进行长程色散校正

 `Ener`  
只对能量进行长程色散校正

### 7.3.12 表格

`table-extension`:: (1) [nm]  
非键势能函数查询表超出最大截断距离后的延伸长度. 该值应足够大以考虑电荷组大小及更新邻区列表时扩散的影响. 不使用用户定义势能时, 对1-4相互作用的查询表会使用相同的表格长度, 此长度与非键相互作用的表格无关. `table-extension`的值决不可能影响`rlist`, `rcoulomb`或`rvdw`的值.

`energygrp-table`:  
当对静电和/或VdW使用用户表格时, 可以在这里列出能量组之间的配对, 这些配对可以使用单独的用户表格. 两个能量组的名称将被追加到表格的文件名中, 追加时按照它们在`energygrps`中定义的顺序, 彼此之间以下划线隔开. 例如, 如果`energygrps = Na Cl Sol`, `energygrp-table = Na Na Na Cl`, 除常规的`table.xvg`外, `mdrun`还会读取`table_Na_Na.xvg`和`table_Na_Cl.xvg`, `table.xvg`将被用于所有其它能量组配对.

### 7.3.13 Ewald

`fourierspacing`: (0.12) [nm]  
对普通的Ewald方法, 盒子尺寸和间距的比值决定了在每个(含符号)方向上使用的波矢数目的下限. 对PME和P3M, 该比率决定了沿每个轴使用的Fourier空间格点数目的下限. 在所有情况下, 每个方向上的数目都可通过非零的`fourier_n[xyz]`重新进行设置. 为优化粒子-粒子相互作用计算和PME网格计算之间的相对负载, 知道下面的事实可能对你会有帮助, 当对库仑截断和PME格点间距使用相同的因子进行缩放时, 静电计算的精确度几乎保持不变.

`fourier-nx` (0) ; `fourier-ny` (0) ; `fourier-nz`: (0)  
使用Ewald方法时, 倒易空间波矢的最高振幅. 使用PME或P3M时, 格点的大小. 这些值会覆盖每个方向的`fourierspacing`设置. 最佳的数值为2, 3, 5和7的幂, 避免使用大的素数.

`pme-order` (4)  
PME内插的阶数. 4对应于立方内插. 当并行运行时, 你可以尝试6/8/10, 并同时减少格点尺寸.

`ewald-rtol` (1e-5)  
Ewald移位的实空间势能在`rcoulomb`处的相对强度由`ewald-rtol`给出. 降低此值会得到更精确的实空间加和, 但计算倒易空间加和时需要更多的波矢.

`ewald-rtol-lj` (1e-3)  
当使用PME计算VdW相互作用时, `ewald-rtol-lj`用于控制`rvdw`处色散能的相对强度, 与`ewald-rtol`控制静电能的方式类似.

`lj-pme-comb-rule` (Geometric)  
LJ-PME倒易部分VdW参数的组合规则. 几何规则比Lorentz-Berthelot规则快得多, 因此通常建议优先选择几何规则, 即便力场的其余部分使用了Lorentz-Berthelot规则.

 `Geometric`  
应用几何组合规则

 `Lorentz-Berthelot`  
应用Lorentz-Berthelot组合规则

`ewald-geometry`: (3d)

 `3d`   
在所有三个维度进行Ewald加和.

 `3dC`  
倒易部分的加和仍然以3D进行, 但对`z`方向的力和势能进行校正以产生伪二维的加和. 如果体系在`x-y`平面具有板状几何结构 , 你可以尝试增加盒子在z方向的长度(盒子的长度取为板高的3倍通常是可以的), 并使用这个选项.

`epsilon-surface`: (0)  
此选项控制3D Ewald加和的偶极校正. 默认值零意味着不进行校正. 将此值设置为围绕无穷大体系的假想表面的相对介电常数值, 即可进行校正. 小心, 如果你的体系含有自由移动的电荷, 你就不应该使用此选项. 这个值不影响长程校正的板状3DC方法.

### 7.3.14 温度耦合

`tcoupl:`

 `no`  
不使用温度耦合.

 `berendsen`  
通过Berendsen恒温器与温度为`ref-t` [K]的热浴耦合, 时间常数`tau-t` [ps]. 多个组可以独立耦合, 这些组可在`tc-grps`中指定, 彼此之间以空格分开.

 `nose-hoover`  
使用扩展系综的Nose-Hoover温度耦合. 参考温度与耦合组的选择方法同上, 但在这种情况下`tau-t` [ps]控制的是平衡时温度涨落的周期, 它与弛豫时间稍有不同. 对NVT模拟, 能量的守恒量会写入能量和日志文件.

 `andersen`  
通过在每个时间步对一部分粒子随机化进行温度耦合. 参考温度和耦合组的选择同上. `tau-t`是每个分子两次随机化之间的平均时间间隔. 此方法对粒子的动力学有一定的抑制作用, 但很少或不出现遍历问题. 目前只能用于速度Verlet, 不能用于约束.

 `andersen-massive`  
通过在不频繁的时间步对所有粒子随机化进行温度耦合. 参考温度和耦合组的选择方法同上. `tau-t`是所有分子两次随机化之间的时间间隔. 此方法对粒子的动力学有一定的抑制作用, 但很少或不出现遍历问题. 目前只能用于速度Verlet,

 `v-rescale`  
通过速度缩放与随机项联用的方法进行温度耦合(JCP 126, 014101). 此恒温器类似于Berendsen耦合, 使用相同的`tau-t`进行缩放, 但随机项确保了能够产生正确的正则系综. 随机数种子通过`ld-seed`设置. 即便对`tau-t=0`该恒温器也工作正常. 对于NVT模拟, 能量的守恒量会写入能量和日志文件.

`nsttcouple: (-1)`  
与温度耦合的频率. 默认值-1表示`nsttcouple`与`nstlist`相等, 除非`nstlist≤0`, 此时会使用10. 对速度Verlet积分方法, `nsttcouple`被设置为1.

`nh-chain-length` (10)  
速度Verlet积分方法中Nose-Hoover恒温链的数目, 蛙跳式`md`积分方法只支持1. Nose-Hoover链变量的数据不会输出到.edr, 但可使用环境变量`GMX_NOSEHOOVER_CHAINS`设置输出.

`tc-grps`:  
独立地耦合到温度浴的组

`tau-t`: [ps]  
耦合的时间常数(`tc-grps`中的每组一个值), -1意味着没有温度耦合

`ref-t`: [K]  
耦合的参考温度(`tc-grps`中的每组一个值)

### 7.3.15 压力耦合

`pcoupl`:

 `no`  
不使用压力耦合. 这意味着盒子的大小固定.

 `berendsen`  
指数弛豫的压力耦合, 时间常数为`tau-p` [ps]. 在每个时间步对盒子进行缩放. 有人认为, 这并不能得到正确的热力学系综, 但在模拟的开始阶段这是缩放盒子的最有效方式.

 `Parrinello-Rahman`  
扩展系综的压力耦合, 盒矢量服从运动方程. 原子的运动方程也耦合到此方程. 没有瞬时的缩放. 与Nose-Hoover温度耦合类似, 时间常数`tau-p` [ps]是平衡时压力的涨落周期. 当你想要在数据收集过程中施加压力缩放时, 这可能是更好的方法, 但需要当心, 如果从不同的压力开始模拟, 你可能会得到非常大的振荡. 对那些精确涨落非常重要的NPT系综的模拟, 或者如果压力耦合时间非常短, 这种方法可能不合适, 因为前面时间步的压力会被GROMACS用于计算当前时间步的压力.

`MTTK`  
Martyna-Tuckerman-Tobias-Klein实现, 只用于`md-vv`或`md-vv-avek`, 非常类似于Parrinello-Rahman. 与Nose-Hoover温度耦合类似, 时间常数`tau-p` [ps]是平衡时压力的涨落周期. 当你想要在数据收集过程中施加压力缩放时, 这可能是更好的方法, 但需要当心, 如果从不同的压力开始模拟, 你可能会得到非常大的振荡. 目前仅支持各向同性缩放.

`pcoupltype`:

 `isotropic`  
各向同性压力耦合, 时间常数为`tau-p` [ps]. 压缩系数和参考压力分布分别通过`compressibility` [bar^-1^]和`ref-p` [bar] 进行设置, 都只需要一个值.

 `semiisotropic`  
压力耦合在`x`和`y`方向各向同性, 但`z`方向上的不同. 对膜模拟有用. 需要两个值, 分别对应于`x/y`方向和`z`方向.

 `anisotropic`  
同上, 需要6个值, 分别是`xx`, `yy`, `zz`, `xy/yx`, `xz/zx`和`yz/zy`分量. 当非对角线压缩系数为零时, 长方体盒子在模拟中仍将保持为长方体. 要注意的是, 各向异性缩放可能会导致模拟盒子的剧烈变形.

 `surface-tension`  
表面张力耦合, 表面平行于xy平面. `z`方向采用正常的压力耦合, 表面张力耦合到盒子的`x/y`维度. `ref-p`的第一个值是参考表面张力与表面数目的乘积, 单位为[bar nm], 第二个值是参考的z-压力, 单位为[bar]. 两个`compressibility`的值(单位[bar^-1^])分别为`x/y`和`z`的方向的压缩系数. z方向压缩系数的值应该具有一定的准确度, 因为它会影响表面张力的收敛性, 也可以将其设置为零以保持盒子的高度固定.

`nstpcouple`: (-1)  
压力耦合的频率. 默认值为-1, 表示`nstpcouple`等于`nstlist`, 除非`nstlist≤0`, 此时使用10. 对速度Verlet积分方法, `nstpcouple`被设置为1.

`tau-p(1)`: [ps]  
耦合的时间常数

`compressibility`: [bar^-1^]  
压缩系数(注意: 现在真的是以bar^-1^为单位了), 处于1个标准大气压, 300 K下的水其压缩系数为4.5e-5 [bar^-1^].

`ref-p`: [bar]  
耦合的参考压力

`refcoord-scaling`:

 `no`  
不修改用于位置限制的参考坐标. 注意, 使用该选项维里和压力将取决于参考坐标的绝对位置.

 `all`  
利用压力耦合缩放矩阵对参考坐标进行缩放.

 `com`  
利用压力耦合缩放矩阵对参考坐标的质心进行缩放. 每个参考坐标到质心的矢量不进行缩放. 只使用一个质心, 即便有多个分子存在位置限制. 在计算初始构型参考坐标的质心时, 不考虑周期性边界条件.
