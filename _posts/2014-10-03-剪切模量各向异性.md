---
 layout: post
 title: 剪切模量各向异性
 categories:
 - 科
 tags:
 - matlab
 - 编程
 math: true
---

- 2014-10-03 10:10:58  硕士生伊国辉对此文有所贡献

以前的[博文](http://jerkwin.github.io/2014/04/17/%E6%9D%90%E6%96%99%E5%BC%B9%E6%80%A7%E6%A8%A1%E9%87%8F%E5%90%84%E5%90%91%E5%BC%82%E6%80%A7%E7%9A%84%E4%B8%89%E7%BB%B4%E5%9B%BE%E7%A4%BA%E6%96%B9%E6%B3%95/)中讲过用matlab作弹性模量(杨氏模量)的各向异性图，这里更进一步, 讲讲剪切模量各向异性的作图。

我们知道，剪切模量定义为: 在某个晶面上沿着某一特定方向施加剪切应力后剪切应力和应变的比值。它的值是和两个方向有关的.

![](/pic/剪切模量.png)

在图中，与向量 $l$ 垂直的平面即是晶体要发生剪切的平面. 由于弹性模量的各向异性，在这一特定平面的不同方向，
施加相同的剪切应力会得到不同的剪切应变，故会得到不同的剪切模量的值。此外, 与杨氏模量不同的是，剪切模量在某一方向 $l$ 上的值还与角度 $\chi$ 有关. 
这就导致剪切模量的各向异性比杨氏模量更加复杂。

虽然剪切模量的各项异性比杨氏模量复杂, 但是作图的方法没有什么本质区别. 作图的关键是它的计算. 

以立方晶系为例, 其杨氏模量

$$E= S_{11}-2(S_{11}-S_{12}-{1 \over 2}S_{44})(l_1^2l_2^2+l_1^2l_3^2+l_2^2l_3^2)$$

相应的剪切模量为

$$\begin{align}
G &=4S_{11}(l_1^2m_1^2+l_2^2m_2^2+l_3^2m_3^2) \\
  &+ 8S_{12}(l_1l_2m_1m_2 +l_1l_3m_1m_3+l_2l_3m_2m_3) \\
  &+ S_{44}[(l_1m_2+l_2m_1)^2+(l_1m_3+l_3m_1)^2+(l_2m_3+l_3m_2)^2] \\
  &= A m_1^2 + B m_2^2 + C m_3^2 + 2D m_1m_2 + 2E m_1m_3 +2F m_2m_3
\end{align}$$

其中

$$l=\left( \begin{matrix}
   \sin \theta \cos \phi   \\
   \sin \theta \sin \phi   \\
   \cos \theta   \\
\end{matrix} \right);\quad m=\left( \begin{matrix}
   \cos \theta \cos \phi \cos \chi -\sin \phi \sin \chi   \\
   \cos \theta \sin \phi \cos \chi +\cos \phi \sin \chi   \\
   -\sin \theta \cos \chi   \\
\end{matrix} \right)$$

通常对剪切模量进行表征时使用其在每一方向上最大值或最小值, 这就需要我们计算剪切模量某一方向的极值.

若令 $$\a=4S_{11}-S_{44}, \b=4S_{12}+S_{44}, \g=S_{44}$$, 则 $G$ 可写为

$$G= A m_1^2 + B m_2^2 + C m_3^2 + 2D m_1m_2 + 2E m_1m_3 +2F m_2m_3$$

其中

$$\begin{align}
A &= \a l_1^2+\g=(4S_{11}-S_{44})l_1^2+S44 \\
B &= \a l_1^2+\g \\
C &= \a l_1^2+\g \\
D &= \b l_1l_2 = (4S_{12}+S_{44})l_1l_2 \\
E &= \b l_1l_3 \\
F &= \b l_2l_3
\end{align}$$

可见 $G$ 为 $m_1, m_2, m_3$ 的二次型, 可根据其正定性判断极值情况. 

根据极值的必要条件, 也可对 $G$ 进行求导, 根据 $m_1, m_2, m_3$ 方程组解的情况进行判断极值情况. 求导后

 $$\begin{bmatrix}
 A  & D & E  \\
 D  & B & F  \\
 E  & F & C  \\
\end{bmatrix}
\left[ \begin{array}{c} m_1 \\ m_2 \\ m_3 \end{array} \right]
=0$$

其行列式

$$\D = (\a^3+2\b^3-3\a\b^2)l_1^2l_2^2l_3^2 + \g(\a^2-\b^2)(l_1^2l_2^2+l_1^2l_3^2+l_2^2l_3^2)+\a\g^2+\g^3$$

这两种情形下, 得到的极值点都为 $(0, 0, 0)$, 但显然无法满足 $m_1^2+m_2^2+m_3^2=1$ 的约束条件, 所以这两种方法都不可行.

换用最笨的方法, 直接将 $m_i$ 的表达式代入, 化简后得到 $G$ 满足的方程. 设

$$\alg
m_1 &= \cos \theta \cos \phi \cos \chi -\sin \phi \sin \chi = P \cos\chi + Q \sin\chi \\
m_2 &= \cos \theta \sin \phi \cos \chi +\cos \phi \sin \chi  = R \cos\chi + S \sin\chi \\
m_3 &= -\sin \theta \cos \chi = T \cos\chi
\ealg$$

则

$$\alg
G &= (APQ + BRS + DPS + DQR + EQT + FST) \sin(2x) \\
  &+ (AP^2 + BR^2 + CT^2 + 2DPR + 2EPT + 2FRT ) \cos^2 x \\
  &+ (AQ^2 + BS^2 + 2DQS ) \sin^2 x \\
  &= C_1 \sin(2x) + C_2 \cos^2 x + C_3 \sin^2 x \\
  &= C_1 \sin(2x) + (C_2-C3) \cos^2 x + C_3 \\
  &= C_1 \sin(2x) + {C_2-C_3 \over 2} \cos(2x) + {C_2+C_3 \over 2} \\
  &= \sqrt{C_1^2+{(C_2-C_3)^2 \over 4}} \sin(2x+\f) + {C_2+C_3 \over 2} , \f= \arctan {C_2-C_3 \over 2 C_1}
\ealg$$

最终表示为简单的三角函数, 容易知道, $G$ 的最大值 

$G_{max}={C_2+C_3 \over 2}+\sqrt{C_1^2+{(C_2-C_3)^2 \over 4}}$

最小值

$G_{min}= {C_2+C_3 \over 2} - \sqrt{C_1^2+{(C_2-C_3)^2 \over 4}}$

上面的推导过程可借助matlab的符号计算功能完成.

虽然有了解析的表达式, 但实际编码时很繁琐, 且大多数情况下我们并不能得到解析的公式. 所以这只是作为求极值的一种方法. 常用的数值方法中最简单的就是分割点直接计算所有值, 然后求其最大值或最小值, 复杂一点的就是利用优化的各种方法.

照例, 下面给出几种典型金属的剪切模量最大值与最小值的图像, 前者为最大值, 后者为最小值.

![](/pic/Nb_Gmax.png) ![](/pic/Nb_Gmin.png)

![](/pic/W_Gmax.png) ![](/pic/W_Gmin.png)

![](/pic/Al_Gmax.png) ![](/pic/Al_Gmin.png)

![](/pic/Pt_Gmax.png) ![](/pic/Pt_Gmin.png)

![](/pic/Fe_Gmax.png) ![](/pic/Fe_Gmin.png)

![](/pic/Ag_Gmax.png) ![](/pic/Ag_Gmin.png)

![](/pic/Pb_Gmax.png) ![](/pic/Pb_Gmin.png)

![](/pic/Li_Gmax.png) ![](/pic/Li_Gmin.png)

### 作图代码

<table class="highlighttable"><th colspan="2" style="text-align:left">Aniso.m</th><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #AA22FF; font-weight: bold">function</span> <span style="color: #00A000">Aniso</span>
    clc; clear; close all;

    <span style="color: #AA22FF; font-weight: bold">global</span> S11 S12 S44

<span style="color: #008800; font-style: italic">%     C11=240.20; C12= 125.60; C44= 28.20; Name=&#39;Nb&#39;; Aniso=&#39;0.49&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11=522.40; C12= 160.80; C44=204.40; Name=&#39;W&#39;;  Aniso=&#39;1.13&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11=107.30; C12=  60.90; C44= 28.30; Name=&#39;Al&#39;; Aniso=&#39;1.22&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11=346.70; C12= 250.70; C44= 76.50; Name=&#39;Pt&#39;; Aniso=&#39;1.59&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11=231.40; C12= 134.70; C44=116.40; Name=&#39;Fe&#39;; Aniso=&#39;2.41&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11=124.00; C12=  93.40; C44= 46.10; Name=&#39;Ag&#39;; Aniso=&#39;3.01&#39;;</span>
<span style="color: #008800; font-style: italic">%     C11= 49.50; C12=  42.30; C44= 14.90; Name=&#39;Pb&#39;; Aniso=&#39;4.14&#39;;</span>
    C11= <span style="color: #666666">13.50</span>; C12=  <span style="color: #666666">11.44</span>; C44=  <span style="color: #666666">8.78</span>; Name=<span style="color: #BB4444">&#39;</span>Li<span style="color: #666666">&#39;</span>; Aniso=<span style="color: #BB4444">&#39;</span><span style="color: #666666">8.52&#39;</span>;

    C=<span style="color: #AA22FF">zeros</span>(<span style="color: #666666">6</span>);
    C(<span style="color: #666666">1</span>:<span style="color: #666666">3</span>,<span style="color: #666666">1</span>:<span style="color: #666666">3</span>)=C12;
    <span style="color: #AA22FF; font-weight: bold">for</span> <span style="color: #AA22FF">i</span>=<span style="color: #666666">1</span>:<span style="color: #666666">3</span>; C(<span style="color: #AA22FF">i</span>,<span style="color: #AA22FF">i</span>)=C11; <span style="color: #AA22FF; font-weight: bold">end</span>
    <span style="color: #AA22FF; font-weight: bold">for</span> <span style="color: #AA22FF">i</span>=<span style="color: #666666">4</span>:<span style="color: #666666">6</span>; C(<span style="color: #AA22FF">i</span>,<span style="color: #AA22FF">i</span>)=C44; <span style="color: #AA22FF; font-weight: bold">end</span>

    S=inv(C);
    S11=S(<span style="color: #666666">1</span>,<span style="color: #666666">1</span>); S12=S(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>); S44=S(<span style="color: #666666">4</span>,<span style="color: #666666">4</span>);

<span style="color: #008800; font-style: italic">%     [X, Y, Z, E] = Eval;</span>
<span style="color: #008800; font-style: italic">%     SphPlt(X, Y, Z, E, [Name,&#39;_E.png&#39;], [Name, &#39; Aniso=&#39;, Aniso]);</span>
<span style="color: #008800; font-style: italic">%     [Gmin, Gmax] = pltGchi(.25*pi, .25*pi);</span>
    [X, Y, Z, G] = Gval;
    SphPlt(X, Y, Z, G, [Name,<span style="color: #BB4444">&#39;</span>_Gmin.png<span style="color: #666666">&#39;</span>], [Name, <span style="color: #BB4444">&#39;</span> Aniso=<span style="color: #BB4444">&#39;</span>, Aniso]);
<span style="color: #AA22FF; font-weight: bold">end</span>
<span style="color: #008800; font-style: italic">%%</span>
<span style="color: #AA22FF; font-weight: bold">function</span><span style="border: 1px solid #FF0000"> [</span><span style="color: #00A000">X</span>, Y, Z, E] = Eval
    <span style="color: #AA22FF; font-weight: bold">global</span> S11 S12 S44

    A=<span style="color: #666666">2*</span>(S11<span style="color: #666666">-</span>S12)<span style="color: #666666">/</span>S44;
    Emax=<span style="color: #666666">1/</span>S11; Emin=<span style="color: #666666">1/</span>(S11<span style="color: #666666">+</span>(<span style="color: #666666">1-</span>A)<span style="color: #666666">*</span>S44<span style="color: #666666">/3</span>);
    <span style="color: #AA22FF; font-weight: bold">if</span>(A<span style="color: #666666">&gt;1</span>); Emin=<span style="color: #666666">1/</span>S11; Emax=<span style="color: #666666">1/</span>(S11<span style="color: #666666">+</span>(<span style="color: #666666">1-</span>A)<span style="color: #666666">*</span>S44<span style="color: #666666">/3</span>); <span style="color: #AA22FF; font-weight: bold">end</span>

    fprintf(<span style="color: #BB4444">&#39;</span>Aniso=<span style="color: #008800; font-style: italic">%9.4f Emin=%9.4f Emax=%9.4f\n&#39;, A, Emin, Emax);</span>

    [theta, phi]=<span style="color: #AA22FF">meshgrid</span>( <span style="color: #AA22FF">linspace</span>(<span style="color: #666666">0</span>,<span style="color: #AA22FF">pi</span>), <span style="color: #AA22FF">linspace</span>(<span style="color: #666666">0</span>,<span style="color: #666666">2*</span><span style="color: #AA22FF">pi</span>) );

    L1=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(phi);
    L2=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(phi);
    L3=<span style="color: #AA22FF">cos</span>(theta);
    E=S11<span style="color: #666666">+</span>(<span style="color: #666666">1-</span>A)<span style="color: #666666">*</span>S44<span style="color: #666666">*</span>( (L1<span style="color: #666666">.*</span>L2)<span style="color: #666666">.^2+</span>(L2<span style="color: #666666">.*</span>L3)<span style="color: #666666">.^2+</span>(L3<span style="color: #666666">.*</span>L1)<span style="color: #666666">.^2</span> );
    E=<span style="color: #666666">1./</span>E;
    X=E<span style="color: #666666">.*</span>L1; Y=E<span style="color: #666666">.*</span>L2; Z=E<span style="color: #666666">.*</span>L3;
<span style="color: #AA22FF; font-weight: bold">end</span>
<span style="color: #008800; font-style: italic">%%</span>
<span style="color: #AA22FF; font-weight: bold">function</span><span style="border: 1px solid #FF0000"> [</span><span style="color: #00A000">X</span>, Y, Z, G] = Gval
    [theta, phi]=<span style="color: #AA22FF">meshgrid</span>( <span style="color: #AA22FF">linspace</span>(<span style="color: #666666">0</span>,<span style="color: #AA22FF">pi</span>,<span style="color: #666666">50</span>), <span style="color: #AA22FF">linspace</span>(<span style="color: #666666">0</span>,<span style="color: #666666">2*</span><span style="color: #AA22FF">pi</span>) );

    L1=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(phi);
    L2=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(phi);
    L3=<span style="color: #AA22FF">cos</span>(theta);

    theta = theta(:);
    phi = phi(:);
    G = <span style="color: #AA22FF">zeros</span>(<span style="color: #AA22FF">length</span>(phi),<span style="color: #666666">1</span>);
    <span style="color: #AA22FF; font-weight: bold">for</span> <span style="color: #AA22FF">i</span>=<span style="color: #666666">1</span>:<span style="color: #AA22FF">length</span>(G)
        [x, Gmin] = fminbnd(@(x) Gchi(theta(<span style="color: #AA22FF">i</span>), phi(<span style="color: #AA22FF">i</span>), x), <span style="color: #666666">0</span>,<span style="color: #AA22FF">pi</span>); G(<span style="color: #AA22FF">i</span>) = Gmin;
<span style="color: #008800; font-style: italic">%         [x, Gmax] = fminbnd(@(x) -Gchi(theta(i), phi(i), x), 0,pi); G(i) = -Gmax;</span>
    <span style="color: #AA22FF; font-weight: bold">end</span>
    G = <span style="color: #AA22FF">reshape</span>(G, <span style="color: #AA22FF">size</span>(L1));
    X=G<span style="color: #666666">.*</span>L1; Y=G<span style="color: #666666">.*</span>L2; Z=G<span style="color: #666666">.*</span>L3;
<span style="color: #AA22FF; font-weight: bold">end</span>
<span style="color: #008800; font-style: italic">%%</span>
<span style="color: #AA22FF; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>G =<span style="color: #bbbbbb"> </span><span style="color: #00A000">Gchi</span>(theta, phi, chi)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #AA22FF; font-weight: bold">global</span> S11 S12 S44

    L1=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(phi);
    L2=<span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(phi);
    L3=<span style="color: #AA22FF">cos</span>(theta);
    M1=<span style="color: #AA22FF">cos</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(phi)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(chi)<span style="color: #666666">-</span><span style="color: #AA22FF">sin</span>(phi)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(chi);
    M2=<span style="color: #AA22FF">cos</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(phi)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(chi)<span style="color: #666666">+</span><span style="color: #AA22FF">cos</span>(phi)<span style="color: #666666">.*</span><span style="color: #AA22FF">sin</span>(chi);
    M3= <span style="color: #666666">-</span><span style="color: #AA22FF">sin</span>(theta)<span style="color: #666666">.*</span><span style="color: #AA22FF">cos</span>(chi);

    G = <span style="color: #666666">4*</span>S11<span style="color: #666666">*</span>( (L1<span style="color: #666666">.*</span>M1)<span style="color: #666666">.^2+</span>(L2<span style="color: #666666">.*</span>M2)<span style="color: #666666">.^2+</span>(L3<span style="color: #666666">.*</span>M3)<span style="color: #666666">.^2</span> ) <span style="color: #008800; font-style: italic">...</span>
      <span style="color: #666666">+</span> <span style="color: #666666">8*</span>S12<span style="color: #666666">*</span>( L1<span style="color: #666666">.*</span>L2<span style="color: #666666">.*</span>M1<span style="color: #666666">.*</span>M2<span style="color: #666666">+</span>L1<span style="color: #666666">.*</span>L3<span style="color: #666666">.*</span>M1<span style="color: #666666">.*</span>M3<span style="color: #666666">+</span>L2<span style="color: #666666">.*</span>L3<span style="color: #666666">.*</span>M2<span style="color: #666666">.*</span>M3) <span style="color: #008800; font-style: italic">...</span>
      <span style="color: #666666">+</span>   S44<span style="color: #666666">*</span>( (L2<span style="color: #666666">.*</span>M3<span style="color: #666666">+</span>M2<span style="color: #666666">.*</span>L3)<span style="color: #666666">.^2+</span>(L1<span style="color: #666666">.*</span>M3<span style="color: #666666">+</span>M1<span style="color: #666666">.*</span>L3)<span style="color: #666666">.^2+</span>(L1<span style="color: #666666">.*</span>M2<span style="color: #666666">+</span>M1<span style="color: #666666">.*</span>L2)<span style="color: #666666">.^2</span> );
    G = <span style="color: #666666">1./</span>G;
<span style="color: #AA22FF; font-weight: bold">end</span>
<span style="color: #008800; font-style: italic">%%</span>
<span style="color: #AA22FF; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>[Gmin, Gmax] =<span style="color: #bbbbbb"> </span><span style="color: #00A000">pltGchi</span>(theta, phi)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>chi=<span style="color: #AA22FF">linspace</span>(<span style="color: #666666">0</span>, <span style="color: #666666">2*</span><span style="color: #AA22FF">pi</span>, <span style="color: #666666">200</span>);
    G = Gchi(theta, phi, chi);
    Gmin=min(G(:));
    Gmax=max(G(:));
    plot(chi,G);
<span style="color: #AA22FF; font-weight: bold">end</span>
<span style="color: #008800; font-style: italic">%%</span>
<span style="color: #AA22FF; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #00A000">SphPlt</span>(X, Y, Z, F, File, Title)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>surf(X,Y,Z,F, <span style="color: #BB4444">&#39;</span>FaceColor<span style="color: #666666">&#39;</span>,<span style="color: #BB4444">&#39;</span>interp<span style="color: #666666">&#39;</span>, <span style="color: #BB4444">&#39;</span>EdgeColor<span style="color: #666666">&#39;</span>,<span style="color: #BB4444">&#39;</span>none<span style="color: #666666">&#39;</span>);

    axis tight; title(Title);
    view(<span style="color: #666666">30</span>,<span style="color: #666666">30</span>); daspect([<span style="color: #666666">1</span> <span style="color: #666666">1</span> <span style="color: #666666">1</span>]);
    camlight; lighting phong;
    cbar=colorbar; title(cbar, <span style="color: #BB4444">&#39;</span>GPa<span style="color: #666666">&#39;</span>);

    set(gca,<span style="color: #BB4444">&#39;</span>position<span style="color: #666666">&#39;</span>,[<span style="color: #666666">0.12</span>,<span style="color: #666666">0.05</span>, <span style="color: #666666">0.6</span>,<span style="color: #666666">0.85</span>]);
    set(gcf,<span style="color: #BB4444">&#39;</span>position<span style="color: #666666">&#39;</span>,[<span style="color: #666666">500</span>,<span style="color: #666666">500</span>, <span style="color: #666666">380</span>,<span style="color: #666666">350</span>]);
    set(gcf, <span style="color: #BB4444">&#39;</span>PaperPositionMode<span style="color: #666666">&#39;</span>, <span style="color: #BB4444">&#39;</span>auto<span style="color: #666666">&#39;</span>);
    print(gcf,<span style="color: #BB4444">&#39;</span><span style="color: #666666">-</span>dpng<span style="color: #666666">&#39;</span>,<span style="color: #BB4444">&#39;</span><span style="color: #666666">-</span>r300<span style="color: #666666">&#39;</span>, File)
<span style="color: #AA22FF; font-weight: bold">end</span>
</pre></div>
</td></tr></table>
### 辅助推导的代码

<table class="highlighttable"><th colspan="2" style="text-align:left">Gexp.m</th><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">clc;

syms A B C D E F G m1 m2 m3 P Q R S T x

m1 = P<span style="color: #666666">*</span><span style="color: #AA22FF">cos</span>(x)<span style="color: #666666">+</span>Q<span style="color: #666666">*</span><span style="color: #AA22FF">sin</span>(x);
m2 = R<span style="color: #666666">*</span><span style="color: #AA22FF">cos</span>(x)<span style="color: #666666">+</span>S<span style="color: #666666">*</span><span style="color: #AA22FF">sin</span>(x);
m3 = T<span style="color: #666666">*</span><span style="color: #AA22FF">cos</span>(x);

G = A<span style="color: #666666">*</span>m1^<span style="color: #666666">2</span> <span style="color: #666666">+</span> B<span style="color: #666666">*</span>m2^<span style="color: #666666">2</span> <span style="color: #666666">+</span> C<span style="color: #666666">*</span>m3^<span style="color: #666666">2</span> <span style="color: #666666">+</span> <span style="color: #666666">2*</span>D<span style="color: #666666">*</span>m1<span style="color: #666666">*</span>m2 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>E<span style="color: #666666">*</span>m1<span style="color: #666666">*</span>m3 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>F<span style="color: #666666">*</span>m2<span style="color: #666666">*</span>m3;

G = expand(G);
G = simple(G);

G=collect(G, <span style="color: #AA22FF">cos</span>(x));
G=collect(G, <span style="color: #AA22FF">sin</span>(x));
G=collect(G, <span style="color: #AA22FF">sin</span>(<span style="color: #666666">2*</span>x));

G
pretty(G)
</pre></div>
</td></tr></table>
### 评论

- 2015-04-01 16:52:10 `棒棒` 真是的太棒了
- 2015-04-01 20:06:30 `Jerkwin` 希望能提供更多信息.

- 2015-11-16 21:01:02 `李润光` 程序很棒，但为何（111）剪切面上不同方向剪切模量是定值？可否给出推导过程或出处？非常感谢！
- 2015-11-16 22:38:25 `Jerkwin` 不是很清楚你的问题, 请说得具体些.
- 2015-11-17 09:33:42 `李润光` 比如Fe是面心立方结构，最易开动的滑移系应该是（111）<-1 1 0>,但根据你的公式计算（111）面上沿任意方向滑移其剪切模量均是同一定值，从最大最小剪切模量图也可以看出，（111）面和（100）面上沿不同方向滑移的剪切模量都是定值，我认为这是不合理的，但没有找到相关的推导，可否请您解释一下。
- 2015-11-17 11:27:41 `Jerkwin` 如果我没理解错的话, 你把图的含义搞混了. 那些图给出的是某一方向上剪切模量的极值, 而不是同chi对应的剪切模量. 如果那样的话, 对每一方向, 都可以做出剪切模量和chi的关系图, 可能那是你想要的.
- 2015-11-17 12:17:40 `李润光` 我懂您的意思，图的含义我理解，是每个晶面上的模量极值。但仔细看一下，您的每一对图中，同种材料（111）面和（100）面上剪切模量的极大值和极小值均是相同的，我也用您的子程序画了这两个面上剪切模量和chi的关系图，是一条水平线，这是我困惑的地方，晶体学上，同一晶面沿不同剪切方向的模量不会是定值，我查找了相关文献，极少看到有关于此方面的推导，非常希望您给予进一步解释。
- 2015-11-17 13:02:20 `Jerkwin` 如果你说的(111)面对应的theta和phi都是PI/4的话, 执行主函数里面的[Gmin, Gmax] = pltGchi(.25*pi, .25*pi)语句会给出G和chi的关系图, 我得到的结果是正弦曲线, 不是直线, 和你说的不同.
- 2015-11-17 13:13:40 `李润光` （111）面theta并非PI/4。按以下语句执行，
		Plane           = [1 1 1];
		pltGchi ( acos( Plane(3)./norm(Plane)), atan( Plane(2)./Plane(1)) );
	输出图形即为（111）面对不同chi的shear modulus，是一条直线。
	Plane = [1 0 0]时也是直线。请您验证一下。
- 2015-11-17 14:40:38 `Jerkwin` 你说的对. 对这个特殊的方向, 剪切模量确实是常数. 原因如下:
	根据最后的公式, 当G为常数时, 只需要满足Gmax=Gmin即可, 这样就可以得到C1=0并且C2=C3. 这两个等式也可以直接从G的第一个表达式看出来. 根据这两个条件就可以算出那些方向上的G为常数.
	我粗略地算了一下,
		C1=-(alpha-beta) sin^2(tht) cos(tht) sin(4phi)/4
		C2-C3=(alpha-beta) sin^2(tht) { sin^2(tht) [ sin^2(2phi)-4 ] + cos(4phi)+3 }
	所以, 当alpha=beta时, G恒为常量. 除此之外, 在特定方向上G也可以为常量.其中的一个解就是你所说的(111)方向, 此时phi=PI/4, C1=0, cos^2(tht)=1/3, C2-C3=0, 满足等式.
	当然, 根据这两个等式, 你还可以算出其他的方向, 我就没有验证了. 你有兴趣的话可以验算一下, 告诉我结果, 以便更新下上面的博文.
- 2015-11-18 17:29:36 `李润光` 恩，我想了下，（111）面模量为定值也是合理的。通常所说的最密排面最易滑移方向指实质上是指临界分切应力较小，势垒比较低。<1 -1 0>方向最易滑移并非因为模量小，而是原子间距小，平均伯氏矢量小，势垒低，这样看来你的计算在晶体学也是合理的。还是想看下原始推导过程，可能更有启发。
- 2015-11-18 23:45:34 `Jerkwin` 我不是研究晶体的, 所以晶体方面的知识不足. 希望你能把这个问题及其含义从晶体学方面论述一下, 我把数学部分补充上, 这样才好整理发布. 你写好后可以发到我的邮箱: Jerkwin@gmail.com.
- 2016-03-15 15:02:34 `敦煌的木桶` 下面这篇文章有推导，另外，对立方晶系而言，确实在(100)和(111)面上沿任意方向的剪切模量的值都是一样的。其他晶系的结果就不是这样的。
	J Elast (2015) 120:87–108 Kevin M. Knowles · Philip R. Howie The Directional Dependence of Elastic Stiffness and Compliance Shear Coefficients and Shear Moduli in Cubic Materials
- 2016-03-17 06:02:36 `Jerkwin` 谢谢提供信息. 等我看过文章之后更新下博文.

- 2016-07-17 07:06:45 `767676` 必须点赞！良心好贴！
- 2016-07-25 16:04:52 `Jerkwin` 谢谢

- 2016-08-15 22:42:29 `767676` 本人在您的程序基础上，尝试做某切面轮廓，加代码如下：
		function SphPlt(X, Y, Z, F, File, Title)
			surf(X,Y,Z,F, 'FaceColor','interp', 'EdgeColor','none');
			hold on
		   % 作模量的某一切面图
		 [X,Y,Z]=meshgrid(linspace(-Gmax,Gmax));
		 contourslice(X,Y,Z,X,x,y,z,[0 0])
			axis tight; title(Title);
			view(30,30); daspect([1 1 1]);
			camlight; lighting phong;
			cbar=colorbar; title(cbar, 'GPa');

			set(gca,'position',[0.12,0.05, 0.6,0.85]);
			set(gcf,'position',[500,500, 380,350]);
			set(gcf, 'PaperPositionMode', 'auto');
			print(gcf,'-dpng','-r300', File)
		end
	但是没有成功，敬请版主点播！
- 2016-08-16 23:51:27 `Jerkwin` 你要理解代码的含义. 你照抄的这几句放在这里不行, 因为大写的XYZ和小写的XYZ弄反了, 而且没有Gmax. 正确的差不多是这样
		hold on
		% 作模量的某一切面图
		[x,y,z]=meshgrid(linspace(-max(F(:)),max(F(:))));
		contourslice(x,y,z,x,X,Y,Z,[0 0])
- 2016-08-17 21:14:02 `767676` 多谢大神点拨！正如您所言，是我没有吃透代码含义，太心急了。敢问大神，能否给出您关于此段程序的引用文献。倘若有所小作，绝不敢忘引用您的原创。
- 2016-08-18 22:23:24 `Jerkwin` 如上所言, 我不是做材料的, 这些东西只不过是我业余帮人写的, 没有必要, 也不可能引用我的文献. 如果你真要引用相关文献的话, 引用上面ELAM的文献吧, 有些公式是我从它的源代码中抽出来的.

- 2016-08-17 17:40:47 `斌` 楼主可否提供立方外其它晶系的剪切模量的计算公式
- 2016-08-18 22:20:13 `Jerkwin` 公式我有, 但太复杂了, 还没有测试正确性. 由于我本人不是做材料的, 所以也没有这种需求. 如果你确实需要计算公式的话, 请参考我的另一篇[博文](http://jerkwin.github.io/2015/03/10/%E6%9D%90%E6%96%99%E5%BC%B9%E6%80%A7%E6%80%A7%E8%B4%A8%E8%AE%A1%E7%AE%97%E7%A8%8B%E5%BA%8FELAM/)那个程序的代码中有你需要的公式.

- 2016-10-27 12:37:45 `好友昵称么` “此外, 与杨氏模量不同的是，剪切模量在某一方向 l 上的值还与角度 χ 有关. 这就导致剪切模量的各向异性比杨氏模量更加复杂。”我想请问下，上面这句话的角度 χ是怎么定义的
- 2016-10-27 21:31:06 `Jerkwin` 上面图中标出了χ 角, 仔细看下.

- 2017-03-12 21:49:50 `流星` 楼主其他晶系的剪切模量公式在哪有啊，能不能提供链接？
- 2017-03-13 11:07:58 `Jerkwin` 上面有人问了, 见我的回复.

- 2017-03-14 00:11:49 `流星` 请问下楼主，求不同晶面的比如（111）的剪切模量，要改代码的哪个部分啊？
- 2017-03-14 08:07:53 `Jerkwin` 不需要改什么, 使用Gchi函数就可以了
- 2017-03-14 19:10:52 `流星` 楼主大大，刚学matlab,对于脚本看的不是很懂，需要画个（111）面的切变模量，你说的用Gchi函数具体怎么操作啊？要是有时间，请指导下，谢谢！
- 2017-03-15 07:27:27 `Jerkwin` 给了theta和phi之后, 函数pltGchi(theta, phi)可以计算G和chi的关系, 并作图. 你试下就知道了.
- 2017-03-15 08:13:33 `流星` 对于（111）面的剪切模量，是不是二维的平面图啊？那知道theta和phi，在哪里调用pltGchi(theta,phi)函数啊，是在最后的function SphPlt（）里面吗，那原来的 surf(X,Y,Z,F, 'FaceColor','interp', 'EdgeColor','none');是不是用#注释掉啊？哈哈，问题有点多，脑袋不灵光，希望楼主能回答。嗯，楼主大才，赞！！
- 2017-03-15 09:44:26 `Jerkwin` 基本语法你都不明白的话, 我说了也是白白浪费时间. 你先去看看matlab的基础再说.
- 2017-03-15 12:09:57 `流星` 好的 ，还是多谢大神啦
