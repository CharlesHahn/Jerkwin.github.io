---
 layout: post
 title: 材料弹性模量各向异性的三维图示方法
 categories: 
 - 科
 tags:
 - 编程
 - matlab
 mathjax: true
---

## 2014-04-17 21:21:03 感谢硕士生伊国辉整理此文

## 2015-03-05 09:31:31 修正公式错误

### 背景原理简介

各向异性广泛存在各种材料之中. 什么是各向异性呢? 简单来说, 就是晶体在不同方向有不同的性能. 我们很容易把各向异性和不均匀性混淆, 其实这是两个完全不同的概念. 各向异性就是说材料的性能与方向有关, 而不均匀性是指材料的性能与部位有关. 拿单晶来说, 内部任一点, 结构与性能都是相同的, 但不同方向却有不同的性能.

晶体是各向异性的, 不同方向性能不一样, 而且有着严格的对称性. 这里要说一下, 对称性是一个很了不起的性质, 在数学, 物理学中都有着广泛的应用, 而且在材料性质的分析中也常用到. 多晶材料存在择优取向, 也有一定的各向异性.

各种材料都有弹性, 大多数材料的弹性性质也具有各向异性. 例如, 在立方晶体中[111]方向通常比[100]方向更难压缩(stiff). 当我们对材料施加载荷, 材料会发生相应的形变, 在弹性范围内, 形变遵循胡克(Hook)定律, 即应力与应变是线性关系, 可以表示为 $\s = C \ve$, 其中, $\s$ 是应力, $\ve$ 是应变, $C$ 为杨氏模量(或称弹性模量), 也常用 $E$ 或 $Y$ 来表示.

材料不同方向上弹性模量不同, 我们怎么描述这种不同呢? 最好用数学方法, 建立数学框架, 准确直观地将弹性各项异性描述出来. 下面我们就进行这种数学的描述. 本人数学水平有限, 不能一步一步推导, 但我们可以简要理解一下推导过程. 弹性各项异性的推导就是利用张量和群论推广胡克定律. 我们先只考虑低阶弹性常数. 考虑二阶的 $C_{ijkl}$, 原来的胡克定律 $\s = C \ve$ 可推广为为矩阵形式

$$\boldsymbol \s =\left( \begin{array}{c} \s_1 \\ \s_2 \\ \s_3 \\ \s_4 \\ \s_5 \\ \s_6 \end{array} \right)
=\begin{bmatrix}
C_{11}  & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\
C_{21}  & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\
C_{31}  & C_{32} & C_{33} & C_{34} & C_{35} & C_{36} \\
C_{41}  & C_{42} & C_{43} & C_{44} & C_{45} & C_{46} \\
C_{51}  & C_{52} & C_{53} & C_{54} & C_{55} & C_{56} \\
C_{61}  & C_{62} & C_{63} & C_{64} & C_{65} & C_{66} \\
\end{bmatrix}
\left( \begin{array}{c} \ve_1 \\ \ve_2 \\ \ve_3 \\ \ve_4 \\ \ve_5 \\ \ve_6 \end{array} \right)
=\mathbf C \boldsymbol \ve$$

这个6乘6的矩阵太复杂了, 好在大多数晶体都具有对称性. 考虑到晶体的对称性, 某些弹性常数必定为零, 而某些则相等. 对于立方晶体, 弹性常数矩阵只有三个独立的常数, $$C_{11}, C_{12}, C_{44}$$ 即变为如下形式：

$$\mathbf C=\begin{bmatrix}
C_{11}  & C_{12} & C_{12} &  0     &  0     &  0 \\
C_{12}  & C_{11} & C_{12} &  0     &  0     &  0 \\
C_{12}  & C_{12} & C_{11} &  0     &  0     &  0 \\
 0      &  0     &  0     & C_{44} &  0     &  0 \\
 0      &  0     &  0     &  0     & C_{44} &  0 \\
 0      &  0     &  0     &  0     &  0     & C_{44} \\
\end{bmatrix}$$

对于立方晶体, 我们可以用与[100], [010], [001]三个晶向的方向余弦来表示任意方向的杨氏模量, 结果如下

$$\begin{align}
{1 \over E} &=S_{11}-2( S_{11}-S_{12}-{S_{44} \over 2} )(l_1^2l_2^2+l_2^2l_3^2+l_3^2l_1^2) \\
   &= S_{11}+(1-A)S_{44}(l_1^2l_2^2+l_2^2l_3^2+l_3^2l_1^2) \\
 A &= 2 {S_{11}-S_{12} \over S_{44}} \\
 \mathbf S &= \mathbf C^{-1}
\end{align}$$

其中 $$S_{11}, S_{12}, S_{44}$$ 分别为立方晶体的三个独立的弹性柔顺系数, 柔顺矩阵 $S$ 与弹性矩阵 $C$ 的矩阵互为逆矩阵. $$l_1, l_2, l_3$$ 为空间某一方向与晶体主轴的方向余弦. $A$ 为各向异性值. 因此, 知道了三个柔顺弹性常数的值, 即可求得空间任一方向的杨氏模量 $E$, $E$ 的大小只与方向有关.

由于 $l_1^2+l_2^2+l_3^2=1, l_1, l_2, l_3 \in [0,1]$, 可以知道杨氏模量的两个极值为

$$\begin{align}
E_1 &={1 \over S_{11} } \\
E_2 &={1 \over S_{11}+{1\over 3}(1-A)S_{44}}
\end{align}$$

前者对应于坐标轴方向, 后者对于与体对角线方法. 根据各向异性值 $A$ 与1的大小不同, 相应于极小或极大值.

### 各向异性的图示

为了直观地表达弹性模量的各向异性, 人们常常将其用三维图来表示. 这种各向异性的直观图示方法具有一般性, 在科学数据可视化中经常遇到. 量子化学中常用的原子轨道的角度分布图就是一例. 具体原理是, 在球坐标系 $(r,\q, \f)$ 中, 对仅依赖于方向的函数 $F(\q, \f)$ 中, 做曲面 $r=F(\q, \f)$. 显然, 当 $F$ 为常数时, 此曲面为球面, 各个方向函数值相同, 不存在各向异性; 当 $F$ 随 $(\q,\f)$ 变化时, 曲面便可表示出函数值的变化.

mathematica中可使用球坐标绘图函数`SphericalPlot3D`来做出这种图, 很多文献中的图就是利用这个函数做的, 请参考这个函数的[说明](http://reference.wolfram.com/mathematica/ref/SphericalPlot3D.html)和相应的弹性模量[示例](http://demonstrations.wolfram.com/AnisotropicElasticity/).

考虑到matlab使用更广泛些, 下面给出基于matlab的绘图方法.

利用matlab绘制各向异性图时, 有两种实现方法. 一种是利用球坐标绘图, 像mathematica那样. 虽然matlab没有球坐标绘图函数, 但可以先将球坐标转换为直角坐标然后再绘图, 也不是很麻烦. 另一种方法是直接使用直角坐标, 利用等值面函数, 绘制函数 $r-E=0$ 的等值面.


下面的代码绘制几种金属的杨氏模量三维各向异性曲面, 弹性常数来源于[这里](http://solidmechanics.org/text/Chapter3_2/Chapter3_2.htm).

<pre class="line-numbers" data-start="0"><code class="language-clike"># Language: clike
function Aniso
	clc;clear;close all;

	C11=240.20; C12= 125.60; C44= 28.20; % Nb
	% C11=522.40; C12= 160.80; C44=204.40; % W
	% C11=107.30; C12=  60.90; C44= 28.30; % Al
	% C11=346.70; C12= 250.70; C44= 76.50; % Pt
	% C11=231.40; C12= 134.70; C44=116.40; % Fe
	% C11=124.00; C12=  93.40; C44= 46.10; % Ag
	% C11= 49.50; C12=  42.30; C44= 14.90; % Pb
	% C11= 13.50; C12=  11.44; C44=  8.78; % Li

	C=zeros(6);
	C(1:3,1:3)=C12;
	for i=1:3; C(i,i)=C11; end
	for i=4:6; C(i,i)=C44; end

	S=inv(C);
	S11=S(1,1); S12=S(1,2); S44=S(4,4);

	A=2*(S11-S12)/S44;
	if(A>1)
		Emin=1/S11; Emax=1/(S11+(1-A)*S44/3);
	else
		Emax=1/S11; Emin=1/(S11+(1-A)*S44/3);
	end
	fprintf('A=%9.4f Emin=%9.4f Emax=%9.4f\n', A, Emin, Emax);

	%% Using Spherical Plot

	theta=linspace(0,pi);
	phi=linspace(0,2*pi);
	[u,v]=meshgrid(theta,phi);

	L1=sin(u).*cos(v);
	L2=sin(u).*sin(v);
	L3=cos(u);
	E=S11+(1-A)*S44*( (L1.*L2).^2+(L2.*L3).^2+(L3.*L1).^2 );
	E=1./E;

	x=E.*L1; y=E.*L2; z=E.*L3;
	% [x,y,z] = sph2cart(v, pi/2-u,E);

	surf(x,y,z,E, 'FaceColor','interp', 'EdgeColor','none');

	%% Using Cartesian Plot

	% t=linspace(-Emax,Emax);
	% [x,y,z]=meshgrid(t,t,t);
	% 
	% r=sqrt(x.^2+y.^2+z.^2);
	% L1=x./r; L2=y./r; L3=z./r;
	% 
	% E=S11+(1-A)*S44*( (L1.*L2).^2+(L2.*L3).^2+(L3.*L1).^2 );
	% E=1./E;
	% v=r-E;
	% 
	% p=patch(isosurface(x,y,z,v,0));
	% isocolors(x,y,z,E,p);
	% isonormals(x,y,z,v,p);
	% set(p,'FaceColor','interp','EdgeColor','none')

	axis tight; title 'Nb A=0.5';
	view(30,30); daspect([1 1 1]);
	camlight; lighting phong;
	cbar=colorbar; title(cbar, 'GPa');

	set(gca,'position',[0.12,0.05, 0.6,0.85]);  
	set(gcf,'position',[500,500, 380,350]);  
	set(gcf, 'PaperPositionMode', 'auto');
	print(gcf,'-dpng','-r300','Nb.png') 
end
</code></pre>

**注意**

1. matlab默认的渲染颜色取决于Z轴大小, 这不符合我们的要求, 因为我们需要用颜色表示E的大小, 这样图形更直观.
2. matlab球坐标转换函数使用的球坐标采用数学约定, 与物理上常用的不同, 使用仰角El, 而非俯视角 $\q$, $El+\q=\p/2$  
	![](/pic/2014-04-17-Sph2Cart.png)
3. 不同晶系杨氏模量的表达式不同, 只要把代码里r的表达式修改成相应的方程即可.
4. 杨氏模量在某一平面内的截面图形可利用极坐标或直角坐标绘制, 原理类似.


为了让大家有一个更直观的了解, 我们把具有不同各向异性值的立方金属选取具有代表性几个, 列于下表

<table><caption>几种金属的弹性数据(单位: GPa)</caption>
<tr>
<th style="text-align:center;">金属</th>
<th style="text-align:center;">C11</th>
<th style="text-align:center;">C12</th>
<th style="text-align:center;">C44</th>
<th style="text-align:center;">S11</th>
<th style="text-align:center;">S12</th>
<th style="text-align:center;">S44</th>
<th style="text-align:center;">A</th>
<th style="text-align:center;">E<sub>min</sub></th>
<th style="text-align:center;">E<sub>max</sub></th>
</tr>
<tr>
<td style="text-align:center;">铌Nb</td>
<td style="text-align:center;">  240.20</td>
<td style="text-align:right;">125.60</td>
<td style="text-align:right;">28.20</td>
<td style="text-align:right;">0.0065</td>
<td style="text-align:right;">-0.0022</td>
<td style="text-align:right;">0.0355</td>
<td style="text-align:right;">0.49</td>
<td style="text-align:right;">80.01</td>
<td colspan="2" style="text-align:right;">153.95</td>
</tr>
<tr>
<td style="text-align:center;">钨W</td>
<td style="text-align:center;">  522.40</td>
<td style="text-align:right;">160.80</td>
<td style="text-align:right;">204.40</td>
<td style="text-align:right;">0.0025</td>
<td style="text-align:right;">-0.0007</td>
<td style="text-align:right;">0.0062</td>
<td style="text-align:right;">1.13</td>
<td style="text-align:right;">446.71</td>
<td colspan="2" style="text-align:right;">493.65</td>
</tr>
<tr>
<td style="text-align:right;">铝Al</td>
<td style="text-align:center;">  107.30</td>
<td style="text-align:right;">60.90</td>
<td style="text-align:right;">28.30</td>
<td style="text-align:right;">0.0158</td>
<td style="text-align:right;">-0.0057</td>
<td style="text-align:right;">0.0353</td>
<td style="text-align:right;">1.22</td>
<td style="text-align:right;">63.20</td>
<td colspan="2" style="text-align:right;">75.57</td>
</tr>
<tr>
<td style="text-align:right;">铂Pt</td>
<td style="text-align:center;">  346.70</td>
<td style="text-align:right;">250.70</td>
<td style="text-align:right;">76.50</td>
<td style="text-align:right;">0.0073</td>
<td style="text-align:right;">-0.0031</td>
<td style="text-align:right;">0.0131</td>
<td style="text-align:right;">1.59</td>
<td style="text-align:right;">136.29</td>
<td colspan="2" style="text-align:right;">210.51</td>
</tr>
<tr>
<td style="text-align:right;">铁Fe</td>
<td style="text-align:center;">  231.40</td>
<td style="text-align:right;">134.70</td>
<td style="text-align:right;">116.40</td>
<td style="text-align:right;">0.0076</td>
<td style="text-align:right;">-0.0028</td>
<td style="text-align:right;">0.0086</td>
<td style="text-align:right;">2.41</td>
<td style="text-align:right;">132.28</td>
<td colspan="2" style="text-align:right;">283.34</td>
</tr>
<tr>
<td style="text-align:right;">银Ag</td>
<td style="text-align:center;">  124.00</td>
<td style="text-align:right;">93.40</td>
<td style="text-align:right;">46.10</td>
<td style="text-align:right;">0.0229</td>
<td style="text-align:right;">-0.0098</td>
<td style="text-align:right;">0.0217</td>
<td style="text-align:right;">3.01</td>
<td style="text-align:right;">43.75</td>
<td colspan="2" style="text-align:right;">120.44</td>
</tr>
<tr>
<td style="text-align:right;">铅Pb</td>
<td style="text-align:center;">   49.50</td>
<td style="text-align:right;">42.30</td>
<td style="text-align:right;">14.90</td>
<td style="text-align:right;">0.0951</td>
<td style="text-align:right;">-0.0438</td>
<td style="text-align:right;">0.0671</td>
<td style="text-align:right;">4.14</td>
<td style="text-align:right;">10.52</td>
<td colspan="2" style="text-align:right;">40.23</td>
</tr>
<tr>
<td style="text-align:right;">锂Li</td>
<td style="text-align:center;">   13.50</td>
<td style="text-align:right;">11.44</td>
<td style="text-align:right;">8.78</td>
<td style="text-align:right;">0.3328</td>
<td style="text-align:right;">-0.1526</td>
<td style="text-align:right;">0.1139</td>
<td style="text-align:right;">8.52</td>
<td style="text-align:right;">3.00</td>
<td colspan="2" style="text-align:right;">21.23</td>
</tr>
</table>

相应的三维杨氏模量图如下

![](/pic/2014-04-17-Aniso-Nb.png)

![](/pic/2014-04-17-Aniso-W.png)

![](/pic/2014-04-17-Aniso-Al.png)

![](/pic/2014-04-17-Aniso-Pt.png)

![](/pic/2014-04-17-Aniso-Fe.png)

![](/pic/2014-04-17-Aniso-Ag.png)

![](/pic/2014-04-17-Aniso-Pb.png)

![](/pic/2014-04-17-Aniso-Li.png)

**参考资料**

1. [Matlab绘图高级部分](http://www.cnblogs.com/jeromeblog/p/3396494.html)
2. [科学计算可视化: 三维流场绘图](http://www1.huachu.com.cn/read/readbookinfo.asp?sectionid=1000006273)
3. [Applied Mechanics of Solids: Constitutive Models  Relations between Stress and Strain](http://solidmechanics.org/text/Chapter3_2/Chapter3_2.htm)
4. [球坐标](http://zh.wikipedia.org/wiki/%E7%90%83%E5%9D%90%E6%A8%99%E7%B3%BB) 
